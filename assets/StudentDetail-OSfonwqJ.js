import{y as _,u as y,a as C,b1 as k,a4 as D,r as A,j as e,w as E,U as $,f as x,m as S,e as R,g as j,A as L,G as g,i as P,aC as B,aB as M,E as v,t as N}from"./index-GzcG7CSS.js";import{C as l}from"./Card-FSc1waky.js";import{B as G}from"./Breadcrumbs-B2TfZ2DQ.js";import{G as H}from"./GradientAvatar-AwIYZPqW.js";import{B as f}from"./Badge-9_pL70Ln.js";import{u as T}from"./usePageTitle-CSRQyC0a.js";import{M as q}from"./mail-BeMqAM3p.js";import{C as w}from"./circle-check-DXK6A2lJ.js";import{I as F}from"./info-DQlfYAyl.js";import{T as z}from"./triangle-alert-DWR7AhnE.js";import"./chevron-right-D8jrJqqK.js";function ae(){T("Student Details");const{id:i}=_(),o=y(),{user:t}=C(),a=t?.role==="preceptor"||t?.role==="site_manager",c=t?.role==="preceptor"||t?.role==="site_manager"||t?.role==="coordinator"||t?.role==="admin",{data:r,isLoading:n}=k(),{data:m}=D(),[u,d]=A.useState(!1),s=(r?.students||[]).find(h=>h.id===i);if(n)return e.jsx("div",{className:"flex justify-center py-24",children:e.jsx(E,{className:"w-8 h-8 animate-spin text-primary-500"})});if(!s)return e.jsxs("div",{className:"text-center py-24",children:[e.jsx($,{className:"w-12 h-12 text-stone-300 mx-auto mb-3"}),e.jsx("h2",{className:"text-lg font-semibold text-stone-900",children:"Student not found"}),e.jsxs(x,{variant:"outline",className:"mt-4",onClick:()=>o("/students"),children:[e.jsx(S,{className:"w-4 h-4 mr-2"})," Back to Students"]})]});const p=s.total_hours??s.prior_hours+s.hours_completed,b=s.hours_required>0?Math.min(100,Math.round(p/s.hours_required*100)):0;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(G,{items:[{label:"My Students",path:"/students"},{label:`${s.first_name} ${s.last_name}`}]}),e.jsx("div",{className:"bg-gradient-to-r from-primary-50 to-secondary-50 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(H,{name:`${s.first_name} ${s.last_name}`,size:"lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h1",{className:"text-2xl font-bold text-stone-900",children:[s.first_name," ",s.last_name]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[s.degree_type&&e.jsx(f,{variant:"primary",children:s.degree_type}),s.university&&e.jsx(f,{variant:"default",children:s.university})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-sm text-stone-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-4 h-4 text-stone-400"})," ",s.email]}),s.graduation_date&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-4 h-4 text-stone-400"})," Graduation: ",new Date(s.graduation_date).toLocaleDateString()]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsx(l,{padding:"sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary-50 text-primary-500 flex items-center justify-center mx-auto mb-2",children:e.jsx(j,{className:"w-5 h-5"})}),e.jsxs("p",{className:"text-xl font-bold text-stone-900",children:[p,"h"]}),e.jsx("p",{className:"text-xs text-stone-500",children:"Total Hours"})]})}),e.jsx(l,{padding:"sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-50 text-green-500 flex items-center justify-center mx-auto mb-2",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsxs("p",{className:"text-xl font-bold text-stone-900",children:[s.hours_completed,"h"]}),e.jsx("p",{className:"text-xs text-stone-500",children:"Platform Hours"})]})}),e.jsx(l,{padding:"sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-50 text-amber-500 flex items-center justify-center mx-auto mb-2",children:e.jsx(j,{className:"w-5 h-5"})}),e.jsxs("p",{className:"text-xl font-bold text-stone-900",children:[s.pending_hours,"h"]}),e.jsx("p",{className:"text-xs text-stone-500",children:"Pending Review"})]})}),e.jsx(l,{padding:"sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-secondary-50 text-secondary-500 flex items-center justify-center mx-auto mb-2",children:e.jsx(g,{className:"w-5 h-5"})}),e.jsxs("p",{className:"text-xl font-bold text-stone-900",children:[s.prior_hours,"h"]}),e.jsx("p",{className:"text-xs text-stone-500",children:"Prior Hours"})]})})]}),e.jsxs(l,{children:[e.jsxs("h2",{className:"text-sm font-semibold text-stone-900 mb-4 flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4 text-primary-500"})," Academic Details"]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 mb-5",children:[e.jsxs("div",{className:"bg-stone-50 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1",children:"University"}),e.jsx("p",{className:"text-sm font-medium text-stone-900",children:s.university||"N/A"})]}),e.jsxs("div",{className:"bg-stone-50 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1",children:"Program"}),e.jsx("p",{className:"text-sm font-medium text-stone-900",children:s.program||"N/A"})]}),e.jsxs("div",{className:"bg-stone-50 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1",children:"Degree"}),e.jsx("p",{className:"text-sm font-medium text-stone-900",children:s.degree_type||"N/A"})]}),s.gpa!=null&&e.jsxs("div",{className:"bg-stone-50 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1",children:"GPA"}),e.jsx("p",{className:"text-sm font-medium text-stone-900",children:Number(s.gpa).toFixed(2)})]}),s.graduation_date&&e.jsxs("div",{className:"bg-stone-50 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1",children:"Graduation Date"}),e.jsx("p",{className:"text-sm font-medium text-stone-900",children:new Date(s.graduation_date).toLocaleDateString()})]}),e.jsxs("div",{className:"bg-stone-50 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1",children:"Required Hours"}),e.jsxs("p",{className:"text-sm font-medium text-stone-900",children:[s.hours_required,"h"]})]})]}),e.jsxs("div",{className:"p-4 bg-stone-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-stone-700",children:"Clinical Hours Progress"}),e.jsxs("span",{className:"text-sm font-bold text-stone-900",children:[b,"%"]})]}),e.jsx("div",{className:"w-full h-3 bg-stone-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-primary-500 to-secondary-500 transition-all",style:{width:`${b}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-stone-500",children:[e.jsxs("span",{children:[p,"h completed",s.prior_hours>0?` (${s.prior_hours}h prior)`:""]}),e.jsxs("span",{children:[s.hours_required,"h required"]})]}),s.pending_hours>0&&e.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[s.pending_hours,"h pending review"]})]})]}),s.clinical_interests&&s.clinical_interests.length>0&&e.jsxs(l,{children:[e.jsxs("h2",{className:"text-sm font-semibold text-stone-900 mb-3 flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4 text-primary-500"})," Clinical Interests"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.clinical_interests.map(h=>e.jsx(f,{variant:"default",children:h},h))})]}),s.bio&&e.jsxs(l,{children:[e.jsx("h2",{className:"text-sm font-semibold text-stone-900 mb-3",children:"About"}),e.jsx("p",{className:"text-sm text-stone-700 leading-relaxed",children:s.bio})]}),c&&e.jsx(I,{studentId:i,applications:m?.data||[],showConfirm:u,setShowConfirm:d}),a&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(x,{variant:"outline",onClick:()=>o("/hours"),className:"flex-1",children:[e.jsx(j,{className:"w-4 h-4 mr-2"})," Review Hours"]}),e.jsxs(x,{onClick:()=>o("/evaluations"),className:"flex-1",children:[e.jsx(g,{className:"w-4 h-4 mr-2"})," Write Evaluation"]})]})]})}function I({studentId:i,applications:o,showConfirm:t,setShowConfirm:a}){const c=o.filter(r=>r.student_id===i&&r.status==="accepted");return c.length===0?null:e.jsx(e.Fragment,{children:c.map(r=>e.jsx(U,{application:r,showConfirm:t,setShowConfirm:a},r.id))})}function U({application:i,showConfirm:o,setShowConfirm:t}){const{data:a,isLoading:c}=B(i.id),r=M(),n=i.slot,m=n?.end_date?new Date(n.end_date)<new Date:!1,u=n?.title||n?.site?.name||"Rotation";return e.jsx(l,{className:"border-2 border-sky-200 bg-gradient-to-r from-sky-50 to-blue-50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-sky-100 text-sky-600 flex items-center justify-center shrink-0 mt-0.5",children:e.jsx(v,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-stone-900 text-sm",children:"Complete Rotation"}),e.jsxs("p",{className:"text-xs text-stone-500 mt-0.5",children:[u,n?.site?.name?` at ${n.site.name}`:""]}),n?.end_date&&e.jsx("p",{className:`text-xs mt-1 ${m?"text-green-600 font-medium":"text-amber-600"}`,children:m?`Rotation ended ${new Date(n.end_date).toLocaleDateString()}`:`Ends ${new Date(n.end_date).toLocaleDateString()}`}),!c&&a&&e.jsx("div",{className:`mt-3 p-3 rounded-xl text-xs ${a.eligible?"bg-green-50 border border-green-200":"bg-amber-50 border border-amber-200"}`,children:e.jsx("div",{className:"flex items-center gap-1.5",children:a.eligible?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-3.5 h-3.5 text-green-600 shrink-0"}),e.jsxs("span",{className:"text-green-700 font-medium",children:["CE Credit: ",a.contact_hours," contact hours will be awarded"]})]}):a.reason?.includes("does not offer")?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-3.5 h-3.5 text-stone-400 shrink-0"}),e.jsx("span",{className:"text-stone-500",children:"CE Credits: Not configured for this university"})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-3.5 h-3.5 text-amber-600 shrink-0"}),e.jsx("span",{className:"text-amber-700",children:a.reason})]})})}),o?e.jsxs("div",{className:"mt-3 p-3 bg-white rounded-xl border border-stone-200",children:[e.jsxs("p",{className:"text-xs text-stone-600 mb-3",children:["This will mark the rotation as completed. ",a?.eligible?`The preceptor will receive ${a.contact_hours} CE contact hours.`:"CE credits may not be awarded (see status above)."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{size:"sm",isLoading:r.isPending,onClick:()=>{r.mutate(i.id,{onSuccess:d=>{N.success("Rotation marked as completed!"),d.ce?.ce_certificate_created&&N.success(`CE certificate created (${d.ce.contact_hours} hrs) â€” Status: ${d.ce.ce_status}`),t(!1)},onError:d=>N.error(d.message)})},children:[e.jsx(w,{className:"w-4 h-4"})," Confirm Complete"]}),e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>t(!1),children:"Cancel"})]})]}):e.jsxs(x,{size:"sm",variant:"outline",className:"mt-3",onClick:()=>t(!0),children:[e.jsx(v,{className:"w-4 h-4"})," Mark Rotation Complete"]})]})]})})}export{ae as StudentDetail};
