import{c as X,a as J,j as e,b1 as ee,r as m,B as z,f as p,af as E,G as F,as as U,i as D,d as se,z as O,g as R,U as te,b2 as ae,K as B,v as T,b3 as re,b4 as ne,b5 as ie,b6 as le,b7 as ce,$ as M,X as de,b8 as oe,b9 as me,t as x,o as W}from"./index-GzcG7CSS.js";import{C as b}from"./Card-FSc1waky.js";import{B as j}from"./Badge-9_pL70Ln.js";import{M as A}from"./Modal-CA0K5bCb.js";import{u as xe}from"./usePageTitle-CSRQyC0a.js";import{M as he}from"./map-pin-B8WKBtoC.js";import{P as ue}from"./phone-D6Tod6__.js";import{G as pe}from"./globe-DMMzYTpl.js";import{U as G}from"./user-plus-CC3Tiyyp.js";import{C as q}from"./chevron-right-D8jrJqqK.js";import{C as L}from"./circle-check-DXK6A2lJ.js";import{C as K}from"./copy-CERpL2dH.js";import{M as $}from"./mail-BeMqAM3p.js";import{U as V}from"./upload-DVvKjw19.js";import{R as ge}from"./refresh-cw-Dmc9F4fM.js";const je=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],fe=X("link",je),Ne=["BSN","MSN","DNP","PA","NP","DPT","OTD","MSW","PharmD","other"],Z={BSN:"primary",MSN:"secondary",DNP:"success",PA:"warning",NP:"primary",DPT:"default",OTD:"default",MSW:"secondary",PharmD:"danger",other:"default"};function H(s){return O({queryKey:["universities",s],queryFn:()=>W.get(`/universities${s?.search?`?search=${s.search}`:""}`)})}function Y(s){return O({queryKey:["university-programs",s],queryFn:()=>W.get(`/universities/${s}/programs`),enabled:!!s})}function Ge(){xe("My University");const{user:s}=J(),c=s?.role==="coordinator",d=s?.universityId||null;return c&&d?e.jsx(ve,{universityId:d}):e.jsx(_e,{})}function ve({universityId:s}){const{data:c,isLoading:d}=H(),{data:i,isLoading:l}=Y(s),{data:o,isLoading:n}=ee(),[t,f]=m.useState(!1),[g,C]=m.useState(null),[_,u]=m.useState(!1),[N,v]=m.useState(null),h=(c?.data||[]).find(a=>a.id===s),y=Array.isArray(i)?i:[],P=o?.students||[],w=m.useMemo(()=>{const a={},k=[];for(const S of P)S.program_id?(a[S.program_id]||(a[S.program_id]=[]),a[S.program_id].push(S)):k.push(S);return{map:a,unassigned:k}},[P]);return d||l||n?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"})}):h?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-stone-900",children:"My University"}),e.jsx("p",{className:"text-stone-500 mt-1",children:"Manage programs and student assignments"})]}),e.jsxs(p,{onClick:()=>f(!0),children:[e.jsx(E,{className:"w-4 h-4 mr-1"})," Add Program"]})]}),e.jsxs(b,{children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-primary-100 to-secondary-100 text-primary-600 flex items-center justify-center shrink-0",children:e.jsx(F,{className:"w-7 h-7"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h2",{className:"text-lg font-bold text-stone-900",children:h.name}),h.is_verified&&e.jsx(j,{variant:"success",size:"sm",children:"Verified"})]}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-sm text-stone-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"w-3.5 h-3.5"})," ",h.city,", ",h.state]}),h.phone&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ue,{className:"w-3.5 h-3.5"})," ",h.phone]}),h.website&&e.jsxs("a",{href:h.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-primary-600 hover:underline",children:[e.jsx(pe,{className:"w-3.5 h-3.5"})," Website"]})]})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsx("p",{className:"text-2xl font-bold text-primary-600",children:y.length}),e.jsx("p",{className:"text-xs text-stone-500",children:"Programs"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4 pt-4 border-t border-stone-100",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-stone-900",children:P.length}),e.jsx("p",{className:"text-xs text-stone-500",children:"Total Students"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-stone-900",children:P.length-w.unassigned.length}),e.jsx("p",{className:"text-xs text-stone-500",children:"Assigned"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-amber-600",children:w.unassigned.length}),e.jsx("p",{className:"text-xs text-stone-500",children:"Unassigned"})]})]})]}),w.unassigned.length>0&&e.jsxs(b,{children:[e.jsxs("button",{onClick:()=>u(!_),className:"w-full flex items-center gap-3 text-left",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-100 text-amber-600 flex items-center justify-center shrink-0",children:e.jsx(G,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"font-semibold text-stone-900",children:[w.unassigned.length," Unassigned Student",w.unassigned.length!==1?"s":""]}),e.jsx("p",{className:"text-sm text-stone-500",children:"These students need to be assigned to a program"})]}),_?e.jsx(U,{className:"w-5 h-5 text-stone-400"}):e.jsx(q,{className:"w-5 h-5 text-stone-400"})]}),_&&e.jsx("div",{className:"mt-4 pt-4 border-t border-stone-100 space-y-2",children:w.unassigned.map(a=>e.jsx(Q,{student:a,programs:y,onAssign:()=>v(a)},a.id))})]}),y.length===0?e.jsx(b,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(D,{className:"w-10 h-10 text-stone-300 mx-auto mb-3"}),e.jsx("h3",{className:"font-semibold text-stone-900 mb-1",children:"No programs yet"}),e.jsx("p",{className:"text-sm text-stone-500 mb-4",children:"Create your first program to start assigning students."}),e.jsxs(p,{onClick:()=>f(!0),variant:"outline",children:[e.jsx(E,{className:"w-4 h-4 mr-1"})," Add Program"]})]})}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-lg font-bold text-stone-900",children:"Programs"}),y.map(a=>{const k=w.map[a.id]||[],S=g===a.id;return e.jsx(Se,{program:a,students:k,allPrograms:y,isExpanded:S,onToggle:()=>C(S?null:a.id),onAssignStudent:v},a.id)})]}),e.jsx(be,{}),e.jsx(ye,{programs:y}),t&&e.jsx(Ie,{universityId:s,onClose:()=>f(!1)}),N&&e.jsx(Ce,{student:N,programs:y,onClose:()=>v(null)})]}):e.jsx(b,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(z,{className:"w-12 h-12 text-stone-300 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-stone-900 mb-1",children:"No university found"}),e.jsx("p",{className:"text-stone-500 text-sm",children:"You are not associated with any university. Contact an admin to link your account."})]})})}function be(){const{data:s,isLoading:c}=ae(),[d,i]=m.useState(null),l=s?.codes||[],o=(t,f)=>{navigator.clipboard.writeText(t),i(f),x.success("Code copied to clipboard"),setTimeout(()=>i(null),2e3)},n=t=>t.is_active?t.expires_at&&new Date(t.expires_at)<new Date?e.jsx(j,{variant:"danger",size:"sm",children:"Expired"}):t.max_uses&&t.times_used>=t.max_uses?e.jsx(j,{variant:"warning",size:"sm",children:"Used"}):e.jsx(j,{variant:"success",size:"sm",children:"Active"}):e.jsx(j,{variant:"default",size:"sm",children:"Deactivated"});return c?e.jsx(b,{children:e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("div",{className:"w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"})})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h2",{className:"text-lg font-bold text-stone-900 flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-primary-500"})," License Codes"]}),l.length===0?e.jsx(b,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(B,{className:"w-10 h-10 text-stone-300 mx-auto mb-3"}),e.jsx("h3",{className:"font-semibold text-stone-900 mb-1",children:"No license codes"}),e.jsx("p",{className:"text-sm text-stone-500",children:"No license codes have been generated for your university yet. Contact an admin to create codes."})]})}):e.jsxs(b,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-stone-100",children:[e.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-stone-500 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-stone-500 uppercase tracking-wider",children:"Usage"}),e.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-stone-500 uppercase tracking-wider",children:"Expires"}),e.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-stone-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-stone-500 uppercase tracking-wider",children:"Created"})]})}),e.jsx("tbody",{className:"divide-y divide-stone-50",children:l.map(t=>e.jsxs("tr",{className:"hover:bg-stone-50 transition-colors",children:[e.jsx("td",{className:"py-2.5 px-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"font-mono text-xs bg-stone-100 px-2 py-1 rounded-md text-stone-800",children:t.code}),e.jsx("button",{onClick:()=>o(t.code,t.id),className:"text-stone-400 hover:text-primary-500 transition-colors",title:"Copy code",children:d===t.id?e.jsx(T,{className:"w-3.5 h-3.5 text-green-500"}):e.jsx(K,{className:"w-3.5 h-3.5"})})]})}),e.jsx("td",{className:"py-2.5 px-3",children:e.jsxs("span",{className:"text-stone-700",children:[t.users_count??t.times_used," / ",t.max_uses??"∞"]})}),e.jsx("td",{className:"py-2.5 px-3 text-stone-500",children:t.expires_at?new Date(t.expires_at).toLocaleDateString():"Never"}),e.jsx("td",{className:"py-2.5 px-3",children:n(t)}),e.jsx("td",{className:"py-2.5 px-3 text-stone-500",children:new Date(t.created_at).toLocaleDateString()})]},t.id))})]})}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-stone-100 text-xs text-stone-500",children:[l.length," code",l.length!==1?"s":""," total"]})]})]})}function ye({programs:s}){const{data:c,isLoading:d}=re(),i=ne(),l=ie(),o=le(),n=ce(),[t,f]=m.useState(!1),[g,C]=m.useState(!1),[_,u]=m.useState(null),N=c?.invites||[],v=N.filter(a=>a.status==="pending"),r=N.filter(a=>a.status==="accepted"),h=N.filter(a=>a.status==="expired"||a.status==="revoked"),y=a=>{const k=`${window.location.origin}/student-invite/${a}`;navigator.clipboard.writeText(k),u(a),x.success("Invite link copied"),setTimeout(()=>u(null),2e3)},P=a=>{o.mutate(a,{onSuccess:k=>x.success(k.message),onError:k=>x.error(k.message||"Failed to resend")})},w=a=>{n.mutate(a,{onSuccess:()=>x.success("Invite revoked"),onError:k=>x.error(k.message||"Failed to revoke")})},I=a=>{switch(a){case"pending":return e.jsx(j,{variant:"warning",size:"sm",children:"Pending"});case"accepted":return e.jsx(j,{variant:"success",size:"sm",children:"Accepted"});case"expired":return e.jsx(j,{variant:"danger",size:"sm",children:"Expired"});case"revoked":return e.jsx(j,{variant:"default",size:"sm",children:"Revoked"});default:return e.jsx(j,{variant:"default",size:"sm",children:a})}};return d?e.jsx(b,{children:e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("div",{className:"w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"})})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-bold text-stone-900 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-primary-500"})," Student Invites"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>C(!0),children:[e.jsx(V,{className:"w-3.5 h-3.5 mr-1"})," Bulk Invite"]}),e.jsxs(p,{size:"sm",onClick:()=>f(!0),children:[e.jsx(M,{className:"w-3.5 h-3.5 mr-1"})," Invite Student"]})]})]}),N.length===0?e.jsx(b,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx($,{className:"w-10 h-10 text-stone-300 mx-auto mb-3"}),e.jsx("h3",{className:"font-semibold text-stone-900 mb-1",children:"No invites sent yet"}),e.jsx("p",{className:"text-sm text-stone-500 mb-4",children:"Invite students to join your university on ClinicLink."}),e.jsxs(p,{onClick:()=>f(!0),variant:"outline",children:[e.jsx(M,{className:"w-4 h-4 mr-1"})," Send First Invite"]})]})}):e.jsxs(b,{children:[v.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-stone-700 mb-2",children:["Pending (",v.length,")"]}),e.jsx("div",{className:"space-y-2",children:v.map(a=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-amber-50 rounded-xl",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-stone-900 truncate",children:a.email||"Open invite link"}),e.jsxs("div",{className:"flex flex-wrap gap-x-3 text-xs text-stone-500 mt-0.5",children:[a.program_name&&e.jsx("span",{children:a.program_name}),e.jsxs("span",{children:["Expires ",new Date(a.expires_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx("button",{onClick:()=>y(a.token),className:"p-1.5 text-stone-400 hover:text-primary-500 transition-colors rounded-lg hover:bg-white",title:"Copy invite link",children:_===a.token?e.jsx(T,{className:"w-3.5 h-3.5 text-green-500"}):e.jsx(fe,{className:"w-3.5 h-3.5"})}),a.email&&e.jsx("button",{onClick:()=>P(a.id),className:"p-1.5 text-stone-400 hover:text-primary-500 transition-colors rounded-lg hover:bg-white",title:"Resend email",disabled:o.isPending,children:e.jsx(ge,{className:`w-3.5 h-3.5 ${o.isPending?"animate-spin":""}`})}),e.jsx("button",{onClick:()=>w(a.id),className:"p-1.5 text-stone-400 hover:text-red-500 transition-colors rounded-lg hover:bg-white",title:"Revoke invite",children:e.jsx(de,{className:"w-3.5 h-3.5"})})]})]},a.id))})]}),r.length>0&&e.jsxs("div",{className:v.length>0?"pt-4 border-t border-stone-100":"",children:[e.jsxs("h3",{className:"text-sm font-semibold text-stone-700 mb-2",children:["Accepted (",r.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.map(a=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-xl",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center text-green-600 shrink-0",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-stone-900 truncate",children:a.accepted_by?.name||a.email||"Student"}),e.jsxs("p",{className:"text-xs text-stone-500",children:[a.accepted_by?.email,a.program_name?` · ${a.program_name}`:""]})]}),I(a.status)]},a.id))})]}),h.length>0&&e.jsxs("div",{className:v.length>0||r.length>0?"pt-4 border-t border-stone-100 mt-4":"",children:[e.jsxs("h3",{className:"text-sm font-semibold text-stone-500 mb-2",children:["Expired / Revoked (",h.length,")"]}),e.jsx("div",{className:"space-y-1",children:h.map(a=>e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 text-stone-400",children:[e.jsx("p",{className:"text-sm truncate flex-1",children:a.email||"Open invite"}),I(a.status)]},a.id))})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-stone-100 text-xs text-stone-500",children:[N.length," invite",N.length!==1?"s":""," total"]})]}),t&&e.jsx(we,{programs:s,onClose:()=>f(!1),createInvite:i}),g&&e.jsx(ke,{programs:s,onClose:()=>C(!1),bulkCreate:l})]})}function we({programs:s,onClose:c,createInvite:d}){const[i,l]=m.useState(""),[o,n]=m.useState(""),[t,f]=m.useState(""),[g,C]=m.useState(null),[_,u]=m.useState(!1),N=()=>{d.mutate({email:i.trim()||void 0,program_id:o||void 0,message:t.trim()||void 0},{onSuccess:r=>{C({url:r.invite.url,email_sent:r.invite.email_sent}),r.invite.email_sent?x.success(`Invite sent to ${r.invite.email}`):r.invite.email?x.warning("Invite created but email failed to send. Share the link manually."):x.success("Open invite link created!")},onError:r=>x.error(r.message||"Failed to create invite")})},v=()=>{g?.url&&(navigator.clipboard.writeText(g.url),u(!0),x.success("Link copied"),setTimeout(()=>u(!1),2e3))};return e.jsx(A,{isOpen:!0,onClose:c,title:"Invite Student",size:"md",children:g?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-3",children:e.jsx(L,{className:"w-7 h-7 text-green-600"})}),e.jsx("h3",{className:"font-semibold text-stone-900",children:"Invite Created!"}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:g.email_sent?"Email sent successfully.":"Share the link below with the student."})]}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-stone-50 rounded-xl",children:[e.jsx("input",{type:"text",readOnly:!0,value:g.url,className:"flex-1 text-xs font-mono bg-transparent text-stone-700 border-none outline-none"}),e.jsx("button",{onClick:v,className:"text-primary-500 hover:text-primary-600 shrink-0",children:_?e.jsx(T,{className:"w-4 h-4 text-green-500"}):e.jsx(K,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{onClick:c,children:"Done"})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Student Email (optional)"}),e.jsx("input",{type:"email",value:i,onChange:r=>l(r.target.value),placeholder:"student@example.edu",className:"w-full border border-stone-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("p",{className:"text-xs text-stone-400 mt-1",children:"Leave blank to create a shareable open invite link."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Program (optional)"}),e.jsxs("select",{value:o,onChange:r=>n(r.target.value),className:"w-full border border-stone-300 rounded-lg px-3 py-2.5 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"-- No program assigned --"}),s.map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.degree_type,")"]},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Personal Message (optional)"}),e.jsx("textarea",{value:t,onChange:r=>f(r.target.value),placeholder:"Welcome to our program! We're excited to have you.",rows:3,className:"w-full border border-stone-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(p,{variant:"outline",onClick:c,children:"Cancel"}),e.jsxs(p,{onClick:N,isLoading:d.isPending,children:[e.jsx(M,{className:"w-4 h-4 mr-1"})," ",i.trim()?"Send Invite":"Create Link"]})]})]})})}function ke({programs:s,onClose:c,bulkCreate:d}){const[i,l]=m.useState(""),[o,n]=m.useState(""),[t,f]=m.useState(""),[g,C]=m.useState(null),u=(r=>{const h=/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g;return[...new Set(r.match(h)||[])]})(i),N=r=>{const h=r.target.files?.[0];if(!h)return;const y=new FileReader;y.onload=P=>{const w=P.target?.result;l(I=>I?`${I}
${w}`:w)},y.readAsText(h),r.target.value=""},v=()=>{if(u.length===0){x.error("No valid email addresses found.");return}d.mutate({emails:u,program_id:o||void 0,message:t.trim()||void 0},{onSuccess:r=>{C(r.summary),x.success(r.message)},onError:r=>x.error(r.message||"Bulk invite failed")})};return e.jsx(A,{isOpen:!0,onClose:c,title:"Bulk Invite Students",size:"md",children:g?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-3",children:e.jsx(L,{className:"w-7 h-7 text-green-600"})}),e.jsx("h3",{className:"font-semibold text-stone-900",children:"Bulk Invite Complete"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-xl",children:[e.jsx("p",{className:"text-lg font-bold text-green-600",children:g.sent}),e.jsx("p",{className:"text-xs text-stone-500",children:"Sent"})]}),e.jsxs("div",{className:"text-center p-3 bg-amber-50 rounded-xl",children:[e.jsx("p",{className:"text-lg font-bold text-amber-600",children:g.skipped}),e.jsx("p",{className:"text-xs text-stone-500",children:"Skipped"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-xl",children:[e.jsx("p",{className:"text-lg font-bold text-red-600",children:g.failed}),e.jsx("p",{className:"text-xs text-stone-500",children:"Failed"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{onClick:c,children:"Done"})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:["Student Emails",u.length>0&&e.jsxs("span",{className:"ml-2 text-xs font-normal text-primary-500",children:[u.length," email",u.length!==1?"s":""," found"]})]}),e.jsx("textarea",{value:i,onChange:r=>l(r.target.value),placeholder:"Paste emails here (one per line, comma-separated, or any text containing emails)...",rows:5,className:"w-full border border-stone-300 rounded-lg px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[e.jsxs("label",{className:"cursor-pointer text-xs text-primary-500 hover:text-primary-600 flex items-center gap-1",children:[e.jsx(V,{className:"w-3 h-3"})," Upload CSV",e.jsx("input",{type:"file",accept:".csv,.txt",onChange:N,className:"hidden"})]}),e.jsx("span",{className:"text-xs text-stone-400",children:"or paste emails above"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Program (optional)"}),e.jsxs("select",{value:o,onChange:r=>n(r.target.value),className:"w-full border border-stone-300 rounded-lg px-3 py-2.5 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"-- No program assigned --"}),s.map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.degree_type,")"]},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Message (optional)"}),e.jsx("textarea",{value:t,onChange:r=>f(r.target.value),placeholder:"Welcome to our program!",rows:2,className:"w-full border border-stone-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(p,{variant:"outline",onClick:c,children:"Cancel"}),e.jsxs(p,{onClick:v,isLoading:d.isPending,disabled:u.length===0,children:[e.jsx(M,{className:"w-4 h-4 mr-1"})," Send ",u.length," Invite",u.length!==1?"s":""]})]})]})})}function Se({program:s,students:c,allPrograms:d,isExpanded:i,onToggle:l,onAssignStudent:o}){return e.jsxs(b,{children:[e.jsxs("button",{onClick:l,className:"w-full flex items-center gap-3 text-left",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary-50 to-secondary-50 text-primary-600 flex items-center justify-center shrink-0",children:e.jsx(D,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-stone-900",children:s.name}),e.jsx(j,{variant:Z[s.degree_type]||"default",size:"sm",children:s.degree_type})]}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-0.5 text-xs text-stone-500 mt-0.5",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"})," ",s.required_hours,"h required"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"})," ",c.length," student",c.length!==1?"s":""]}),s.specialties&&s.specialties.length>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3"})," ",s.specialties.join(", ")]})]})]}),i?e.jsx(U,{className:"w-5 h-5 text-stone-400 shrink-0"}):e.jsx(q,{className:"w-5 h-5 text-stone-400 shrink-0"})]}),i&&e.jsx("div",{className:"mt-4 pt-4 border-t border-stone-100",children:c.length===0?e.jsx("p",{className:"text-sm text-stone-500 text-center py-4",children:"No students assigned to this program yet."}):e.jsx("div",{className:"space-y-2",children:c.map(n=>e.jsx(Q,{student:n,programs:d,onAssign:()=>o(n),showReassign:!0},n.id))})})]})}function Q({student:s,programs:c,onAssign:d,showReassign:i}){const l=s.hours_required>0?Math.min(100,Math.round(s.total_hours/s.hours_required*100)):0;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-stone-50 rounded-xl",children:[e.jsxs("div",{className:"w-9 h-9 rounded-full bg-primary-100 flex items-center justify-center text-primary-700 font-semibold text-sm shrink-0",children:[s.first_name[0],s.last_name[0]]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium text-stone-900 truncate",children:[s.first_name," ",s.last_name]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-stone-500 mt-0.5",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"})," ",s.total_hours,"/",s.hours_required,"h"]}),l>0&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-16 h-1.5 bg-stone-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${l>=100?"bg-green-500":l>=50?"bg-primary-500":"bg-amber-500"}`,style:{width:`${l}%`}})}),e.jsxs("span",{className:"text-[10px]",children:[l,"%"]})]})]})]}),e.jsx(p,{variant:"ghost",size:"sm",onClick:d,children:i?"Reassign":"Assign"})]})}function Ce({student:s,programs:c,onClose:d}){const i=me(),[l,o]=m.useState(s.program_id||""),n=()=>{if(!l){x.error("Please select a program.");return}i.mutate({studentId:s.id,programId:l},{onSuccess:()=>{x.success(`${s.first_name} ${s.last_name} assigned successfully.`),d()},onError:t=>x.error(t.message||"Failed to assign student.")})};return e.jsx(A,{isOpen:!0,onClose:d,title:`Assign ${s.first_name} ${s.last_name}`,size:"sm",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-stone-50 rounded-xl",children:[e.jsxs("div",{className:"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center text-primary-700 font-semibold text-sm shrink-0",children:[s.first_name[0],s.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-stone-900",children:[s.first_name," ",s.last_name]}),e.jsx("p",{className:"text-xs text-stone-500",children:s.email})]})]}),s.program&&e.jsxs("p",{className:"text-sm text-stone-500",children:["Currently in: ",e.jsx("span",{className:"font-medium text-stone-700",children:s.program})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Select Program"}),e.jsxs("select",{value:l,onChange:t=>o(t.target.value),className:"w-full border border-stone-300 rounded-lg px-3 py-2.5 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"-- Choose a program --"}),c.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.degree_type,") - ",t.required_hours,"h"]},t.id))]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(p,{variant:"outline",onClick:d,children:"Cancel"}),e.jsxs(p,{onClick:n,isLoading:i.isPending,children:[e.jsx(G,{className:"w-4 h-4 mr-1"})," Assign"]})]})]})})}function _e(){const[s,c]=m.useState(""),{data:d,isLoading:i}=H({search:s||void 0}),l=d?.data||[],[o,n]=m.useState(null);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-stone-900",children:"Programs"}),e.jsx("p",{className:"text-stone-500 mt-1",children:"Universities and their clinical programs"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-stone-400"}),e.jsx("input",{type:"text",placeholder:"Search universities...",value:s,onChange:t=>c(t.target.value),className:"w-full pl-10 pr-4 py-2.5 rounded-xl border border-stone-300 bg-white text-sm focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none"})]}),i?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"})}):l.length===0?e.jsx(b,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(z,{className:"w-12 h-12 text-stone-300 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-stone-900 mb-1",children:"No universities found"}),e.jsx("p",{className:"text-stone-500 text-sm",children:"Try adjusting your search criteria."})]})}):e.jsx("div",{className:"space-y-3",children:l.map(t=>e.jsx(Pe,{university:t,isExpanded:o===t.id,onToggle:()=>n(o===t.id?null:t.id)},t.id))})]})}function Pe({university:s,isExpanded:c,onToggle:d}){const{data:i,isLoading:l}=Y(c?s.id:""),o=Array.isArray(i)?i:[];return e.jsxs(b,{children:[e.jsxs("button",{onClick:d,className:"w-full flex items-center gap-4 text-left",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-primary-100 to-secondary-100 text-primary-600 flex items-center justify-center shrink-0",children:e.jsx(z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-stone-900",children:s.name}),e.jsxs("p",{className:"text-sm text-stone-500",children:[s.city,", ",s.state]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.is_verified&&e.jsx(j,{variant:"success",size:"sm",children:"Verified"}),c?e.jsx(U,{className:"w-5 h-5 text-stone-400"}):e.jsx(q,{className:"w-5 h-5 text-stone-400"})]})]}),c&&e.jsx("div",{className:"mt-4 pt-4 border-t border-stone-100",children:l?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"})}):o.length===0?e.jsx("p",{className:"text-sm text-stone-500 text-center py-4",children:"No programs listed for this university."}):e.jsx("div",{className:"space-y-3",children:o.map(n=>e.jsxs("div",{className:"p-3 bg-stone-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-primary-500 shrink-0"}),e.jsx("h4",{className:"text-sm font-semibold text-stone-900",children:n.name})]}),e.jsx(j,{variant:Z[n.degree_type]||"default",size:"sm",children:n.degree_type})]}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-xs text-stone-500 ml-6",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"})," ",n.required_hours,"h required"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"})," ",n.degree_type]})]}),n.specialties&&n.specialties.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2 ml-6",children:n.specialties.map(t=>e.jsx(j,{variant:"default",size:"sm",children:t},t))})]},n.id))})})]})}function Ie({universityId:s,onClose:c}){const d=oe(),[i,l]=m.useState({name:"",degree_type:"MSN",required_hours:500,specialties:""}),o=()=>{if(!i.name.trim()){x.error("Program name is required.");return}const n=i.specialties.split(",").map(t=>t.trim()).filter(Boolean);d.mutate({universityId:s,data:{name:i.name.trim(),degree_type:i.degree_type,required_hours:i.required_hours,specialties:n.length>0?n:void 0}},{onSuccess:()=>{x.success("Program created successfully."),c()},onError:t=>x.error(t.message||"Failed to create program.")})};return e.jsx(A,{isOpen:!0,onClose:c,title:"Add New Program",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Program Name"}),e.jsx("input",{type:"text",value:i.name,onChange:n=>l({...i,name:n.target.value}),placeholder:"e.g. Family Nurse Practitioner",className:"w-full border border-stone-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Degree Type"}),e.jsx("select",{value:i.degree_type,onChange:n=>l({...i,degree_type:n.target.value}),className:"w-full border border-stone-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:Ne.map(n=>e.jsx("option",{value:n,children:n},n))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Required Clinical Hours"}),e.jsx("input",{type:"number",min:"0",value:i.required_hours,onChange:n=>l({...i,required_hours:Number(n.target.value)}),className:"w-full border border-stone-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Specialties (comma-separated)"}),e.jsx("input",{type:"text",value:i.specialties,onChange:n=>l({...i,specialties:n.target.value}),placeholder:"e.g. Family Practice, Pediatrics, Women's Health",className:"w-full border border-stone-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(p,{variant:"outline",onClick:c,children:"Cancel"}),e.jsxs(p,{onClick:o,isLoading:d.isPending,children:[e.jsx(E,{className:"w-4 h-4 mr-1"})," Create Program"]})]})]})})}export{Ge as Programs};
