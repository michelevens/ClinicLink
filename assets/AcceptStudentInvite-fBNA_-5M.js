import{y as I,a as S,u as E,r as n,J as j,j as e,w as U,L as c,f as r,G as p,i as Y,t as g}from"./index-GzcG7CSS.js";import{T as f}from"./triangle-alert-DWR7AhnE.js";import{C as v}from"./circle-check-big-B5eOtT2b.js";import{A as _}from"./arrow-right-CU9vIbfs.js";import{M as G}from"./map-pin-B8WKBtoC.js";import{L as B}from"./log-in-10vrFb_d.js";import{U as P}from"./user-plus-CC3Tiyyp.js";function F(){const{token:a}=I(),{isAuthenticated:l,user:o}=S(),d=E(),[s,N]=n.useState(null),[b,m]=n.useState(!0),[x,y]=n.useState(""),[w,h]=n.useState(!1),[u,A]=n.useState(!1),[i,k]=n.useState(null);n.useEffect(()=>{a&&j.validate(a).then(t=>{t.already_accepted?k(t.university_name||"the university"):N(t.invite),m(!1)}).catch(t=>{y(t.message||"Invalid invite link"),m(!1)})},[a]);const C=async()=>{if(a){h(!0);try{const t=await j.accept(a);g.success(t.message),A(!0)}catch(t){const L=t instanceof Error?t.message:"Failed to accept invite";g.error(L)}h(!1)}};if(b)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center",children:e.jsx(U,{className:"w-8 h-8 animate-spin text-primary-500"})});if(x)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-white to-orange-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-red-100 text-red-500 flex items-center justify-center mx-auto mb-4",children:e.jsx(f,{className:"w-8 h-8"})}),e.jsx("h1",{className:"text-xl font-bold text-stone-900 mb-2",children:"Invalid Invite"}),e.jsx("p",{className:"text-stone-500 mb-6",children:x}),e.jsx(c,{to:"/login",children:e.jsx(r,{children:"Go to Login"})})]})});if(u||i){const t=u?s?.university.name:i;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-teal-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-100 text-green-500 flex items-center justify-center mx-auto mb-4",children:e.jsx(v,{className:"w-8 h-8"})}),e.jsx("h1",{className:"text-xl font-bold text-stone-900 mb-2",children:i?"You're Already Enrolled!":"You've Joined!"}),e.jsxs("p",{className:"text-stone-500 mb-2",children:["You are now a student at ",e.jsx("strong",{children:t}),"."]}),s?.program&&e.jsxs("p",{className:"text-sm text-stone-400 mb-2",children:["Program: ",e.jsx("strong",{children:s.program.name})," (",s.program.degree_type,")"]}),e.jsx("p",{className:"text-sm text-stone-400 mb-6",children:"Your coordinator can now manage your program placement and track your progress."}),e.jsxs(r,{onClick:()=>d("/dashboard"),children:["Go to Dashboard ",e.jsx(_,{className:"w-4 h-4"})]})]})})}return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary-500 to-secondary-500 px-8 py-6 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center",children:e.jsx(p,{className:"w-7 h-7"})}),e.jsx("span",{className:"text-2xl font-bold",children:"ClinicLink"})]}),e.jsx("p",{className:"text-white/80 text-sm",children:"You've been invited to join a university"})]}),e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"bg-stone-50 rounded-2xl p-5 mb-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-primary-500 to-secondary-500 text-white flex items-center justify-center flex-shrink-0",children:e.jsx(p,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-stone-900",children:s?.university.name}),(s?.university.city||s?.university.state)&&e.jsxs("p",{className:"text-sm text-stone-500 flex items-center gap-1 mt-0.5",children:[e.jsx(G,{className:"w-3.5 h-3.5"}),[s.university.city,s.university.state].filter(Boolean).join(", ")]}),s?.program&&e.jsxs("div",{className:"flex items-center gap-1.5 mt-2",children:[e.jsx(Y,{className:"w-3.5 h-3.5 text-primary-500"}),e.jsxs("span",{className:"text-sm text-stone-700 font-medium",children:[s.program.name," (",s.program.degree_type,")"]})]})]})]})}),s?.invited_by&&e.jsxs("p",{className:"text-sm text-stone-500 mb-6 text-center",children:["Invited by ",e.jsx("strong",{className:"text-stone-700",children:s.invited_by})]}),l&&o?.role==="student"?e.jsxs(r,{className:"w-full",onClick:C,isLoading:w,children:[e.jsx(v,{className:"w-4 h-4"})," Accept & Join University"]}):l?e.jsxs("div",{className:"text-center space-y-3",children:[e.jsxs("div",{className:"bg-amber-50 text-amber-800 rounded-xl px-4 py-3 text-sm",children:[e.jsx(f,{className:"w-4 h-4 inline mr-1"}),"Only student accounts can accept student invites. You're logged in as ",e.jsx("strong",{children:o?.role}),"."]}),e.jsx(r,{variant:"outline",onClick:()=>d("/dashboard"),children:"Go to Dashboard"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-stone-600 text-center mb-4",children:"Log in or register as a student to join this university."}),e.jsx(c,{to:`/login?redirect=/student-invite/${a}`,className:"block",children:e.jsxs(r,{className:"w-full",children:[e.jsx(B,{className:"w-4 h-4"})," Log In"]})}),e.jsx(c,{to:`/register?redirect=/student-invite/${a}&role=student${s?.email?`&email=${encodeURIComponent(s.email)}`:""}`,className:"block",children:e.jsxs(r,{variant:"outline",className:"w-full",children:[e.jsx(P,{className:"w-4 h-4"})," Create Account"]})})]})]})]})})}export{F as AcceptStudentInvite};
