import{c as me,O as ke,P as Ce,Q as _e,j as e,X as Ae,w as he,d as Q,R as Me,T as De,a as ze,u as Le,r as d,V as $e,M as Fe,W as Pe,Y as Te,b as Ie,Z as Re,f as x,_ as Be,B as L,e as H,U as de,g as xe,$,S as W,i as Oe,m as Ue,t as k}from"./index-GzcG7CSS.js";import{u as Ee}from"./usePageTitle-CSRQyC0a.js";import{C as F}from"./Card-FSc1waky.js";import{B as o}from"./Badge-9_pL70Ln.js";import{I as Ve}from"./Input-B5MQDJHu.js";import{M as Y}from"./Modal-CA0K5bCb.js";import{M as He,T as We,a as Ye,P as qe,L as Ge}from"./leaflet-aOLJjKD0.js";import{H as q}from"./heart-C_2-D3rA.js";import{S as Ke}from"./save-Ba530v52.js";import{C as Qe}from"./chevron-right-D8jrJqqK.js";import{M as G}from"./map-pin-B8WKBtoC.js";import{S as C}from"./star-CqpiQmYF.js";import{L as K}from"./log-in-10vrFb_d.js";import{D as Ze}from"./dollar-sign-B0eOAqoO.js";import{S as Je}from"./shield-B4OQBYN4.js";import{C as p}from"./circle-check-DXK6A2lJ.js";import{P as Xe}from"./phone-D6Tod6__.js";import{G as es}from"./globe-DMMzYTpl.js";const ss=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M17 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 .258-1.742",key:"178tsu"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.668 3.01A6 6 0 0 1 18 8c0 2.687.77 4.653 1.707 6.05",key:"1hqiys"}]],ts=me("bell-off",ss);const as=[["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]],is=me("bookmark",as);function ns({onClose:r,onLoadSearch:h}){const{data:l,isLoading:m}=ke(),_=Ce(),u=_e(),A=i=>{u.mutate({id:i.id,data:{alerts_enabled:!i.alerts_enabled}})};return e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-stone-200 w-full max-w-sm",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-stone-200",children:[e.jsx("h3",{className:"font-semibold text-stone-900 text-sm",children:"Saved Searches"}),e.jsx("button",{onClick:r,className:"p-1 rounded-lg hover:bg-stone-100 text-stone-400",children:e.jsx(Ae,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto",children:m?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(he,{className:"w-5 h-5 animate-spin text-stone-400"})}):!l||l.length===0?e.jsxs("div",{className:"text-center py-8 px-4",children:[e.jsx(Q,{className:"w-8 h-8 text-stone-300 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-stone-500",children:"No saved searches yet"}),e.jsx("p",{className:"text-xs text-stone-400 mt-1",children:'Use "Save Search" to save your current filters'})]}):e.jsx("div",{className:"divide-y divide-stone-100",children:l.map(i=>e.jsx("div",{className:"px-4 py-3 hover:bg-stone-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("button",{onClick:()=>{h(i.filters),r()},className:"flex-1 text-left",children:[e.jsx("p",{className:"text-sm font-medium text-stone-900",children:i.name}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[i.filters.search&&e.jsxs("span",{className:"text-xs bg-stone-100 text-stone-600 px-1.5 py-0.5 rounded",children:['"',i.filters.search,'"']}),i.filters.specialty&&e.jsx("span",{className:"text-xs bg-primary-50 text-primary-700 px-1.5 py-0.5 rounded",children:i.filters.specialty}),i.filters.cost_type&&e.jsx("span",{className:"text-xs bg-green-50 text-green-700 px-1.5 py-0.5 rounded",children:i.filters.cost_type})]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx("button",{onClick:()=>A(i),className:`p-1.5 rounded-lg transition-colors ${i.alerts_enabled?"text-primary-600 bg-primary-50":"text-stone-400 hover:bg-stone-100"}`,title:i.alerts_enabled?"Alerts on":"Alerts off",children:i.alerts_enabled?e.jsx(Me,{className:"w-3.5 h-3.5"}):e.jsx(ts,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>_.mutate(i.id),className:"p-1.5 rounded-lg text-stone-400 hover:text-red-600 hover:bg-red-50 transition-colors",title:"Delete",children:e.jsx(De,{className:"w-3.5 h-3.5"})})]})]})},i.id))})})]})}const rs={AL:[32.806671,-86.79113],AK:[61.370716,-152.404419],AZ:[33.729759,-111.431221],AR:[34.969704,-92.373123],CA:[36.116203,-119.681564],CO:[39.059811,-105.311104],CT:[41.597782,-72.755371],DE:[39.318523,-75.507141],FL:[27.766279,-81.686783],GA:[33.040619,-83.643074],HI:[21.094318,-157.498337],ID:[44.240459,-114.478828],IL:[40.349457,-88.986137],IN:[39.849426,-86.258278],IA:[42.011539,-93.210526],KS:[38.5266,-96.726486],KY:[37.66814,-84.670067],LA:[31.169546,-91.867805],ME:[44.693947,-69.381927],MD:[39.063946,-76.802101],MA:[42.230171,-71.530106],MI:[43.326618,-84.536095],MN:[45.694454,-93.900192],MS:[32.741646,-89.678696],MO:[38.456085,-92.288368],MT:[46.921925,-110.454353],NE:[41.12537,-98.268082],NV:[38.313515,-117.055374],NH:[43.452492,-71.563896],NJ:[40.298904,-74.521011],NM:[34.840515,-106.248482],NY:[42.165726,-74.948051],NC:[35.630066,-79.806419],ND:[47.528912,-99.784012],OH:[40.388783,-82.764915],OK:[35.565342,-96.928917],OR:[44.572021,-122.070938],PA:[40.590752,-77.209755],RI:[41.680893,-71.51178],SC:[33.856892,-80.945007],SD:[44.299782,-99.438828],TN:[35.747845,-86.692345],TX:[31.054487,-97.563461],UT:[40.150032,-111.862434],VT:[44.045876,-72.710686],VA:[37.769337,-78.169968],WA:[47.400902,-121.490494],WV:[38.491226,-80.954456],WI:[44.268543,-89.616508],WY:[42.755966,-107.30249],DC:[38.897438,-77.026817]};function ls(r,h){const l=h*137.508*(Math.PI/180),m=.12+h%5*.06;return[r[0]+m*Math.cos(l),r[1]+m*Math.sin(l)]}function cs(r,h){const l=h?30:22,m=r?"#22c55e":"#94a3b8";return Ge.divIcon({className:"custom-marker",html:`<div style="width:${l}px;height:${l}px;background:${m};border:3px solid white;border-radius:50%;box-shadow:0 2px 8px rgba(0,0,0,0.3);transition:all 0.2s;${h?"transform:scale(1.2);":""}"></div>`,iconSize:[l,l],iconAnchor:[l/2,l/2]})}function _s(){Ee("Search Rotations");const{isAuthenticated:r,user:h}=ze(),l=Le(),[m,_]=d.useState(""),[u,A]=d.useState(""),[i,Z]=d.useState("all"),[P,J]=d.useState("all"),[t,v]=d.useState(null),[pe,b]=d.useState(!1),[ue,j]=d.useState(!1),[T,X]=d.useState(""),[f,I]=d.useState("list"),[R,B]=d.useState("all"),[ee,O]=d.useState(!1),[M,U]=d.useState(""),[se,te]=d.useState(!1),[je,E]=d.useState(!1),D=h?.role==="student",fe=$e(),ae=Fe(),{data:ge}=Pe(void 0,r),y=new Set((ge?.data||[]).map(s=>s.id)),ie=Te(),{data:Ne,isLoading:g}=Ie({search:m||void 0,specialty:u||void 0,status:P!=="all"?P:void 0,cost_type:i!=="all"?i:void 0}),ne=Re(),re=(s,n)=>{if(n?.stopPropagation(),!r){l("/login?redirect=/rotations");return}fe.mutate(s,{onSuccess:a=>k.success(a.bookmarked?"Bookmarked!":"Removed bookmark")})},le=()=>{M.trim()&&ie.mutate({name:M,filters:{...m?{search:m}:{},...u?{specialty:u}:{},...i!=="all"?{cost_type:i}:{}},alerts_enabled:!0},{onSuccess:()=>{k.success("Search saved!"),O(!1),U("")},onError:s=>k.error(s.message)})},ve=s=>{_(s.search||""),A(s.specialty||""),Z(s.cost_type||"all"),J(s.status||"all"),B("all")},w=Ne?.data||[],N=R==="saved"?w.filter(s=>y.has(s.id)):w,be=d.useMemo(()=>{const s=new Set(w.map(n=>n.specialty));return Array.from(s).sort()},[w]),ye=async()=>{if(t)try{await ne.mutateAsync({slot_id:t.id,cover_letter:T||void 0}),k.success("Application submitted successfully! You'll hear back within 5-7 business days."),j(!1),X(""),v(null),b(!1)}catch(s){const n=s;if(n.status===403&&n.message?.includes("upgrade")){j(!1),E(!0);return}const a=s instanceof Error?s.message:"Failed to submit application";k.error(a)}},we=()=>{ae.mutate({plan:"pro",interval:"month"},{onSuccess:s=>{window.location.href=s.url},onError:()=>{l("/pricing")}})},S=s=>{v(s),b(!0)},ce=(s,n)=>{if(n?.stopPropagation(),!r){l("/login?redirect=/rotations");return}v(s),j(!0)},Se=s=>{const n=new Date(s),a=new Date;return Math.ceil((n.getTime()-a.getTime())/(1e3*60*60*24))},z=(s,n)=>{const a=new Date(s),c=new Date(n);return Math.round((c.getTime()-a.getTime())/(1e3*60*60*24*7))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-stone-900",children:"Search Rotations"}),e.jsx("p",{className:"text-stone-500",children:"Find your perfect clinical placement"})]}),e.jsxs(F,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Ve,{placeholder:"Search by specialty, site name, or city...",value:m,onChange:s=>_(s.target.value),icon:e.jsx(Q,{className:"w-4 h-4"})})}),e.jsxs("div",{className:"grid grid-cols-2 sm:flex gap-3",children:[e.jsxs("select",{value:u,onChange:s=>A(s.target.value),className:"rounded-xl border border-stone-300 px-3 py-2.5 text-sm bg-white focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none col-span-2 sm:col-span-1",children:[e.jsx("option",{value:"",children:"All Specialties"}),be.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{value:i,onChange:s=>Z(s.target.value),className:"rounded-xl border border-stone-300 px-3 py-2.5 text-sm bg-white focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none",children:[e.jsx("option",{value:"all",children:"Any Cost"}),e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"paid",children:"Paid"})]}),e.jsxs("select",{value:P,onChange:s=>J(s.target.value),className:"rounded-xl border border-stone-300 px-3 py-2.5 text-sm bg-white focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none",children:[e.jsx("option",{value:"all",children:"Any Status"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"filled",children:"Filled"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[r&&D&&e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{onClick:()=>B("all"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-all ${R==="all"?"bg-primary-100 text-primary-700":"text-stone-500 hover:bg-stone-100"}`,children:["All (",w.length,")"]}),e.jsxs("button",{onClick:()=>B("saved"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-all flex items-center gap-1 ${R==="saved"?"bg-primary-100 text-primary-700":"text-stone-500 hover:bg-stone-100"}`,children:[e.jsx(q,{className:"w-3 h-3"})," Saved (",y.size,")"]})]}),e.jsx("p",{className:"text-sm text-stone-500",children:g?"Searching...":`${N.length} rotation${N.length!==1?"s":""} found`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r&&D&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>te(!se),children:[e.jsx(is,{className:"w-3.5 h-3.5"})," Saved Searches"]}),se&&e.jsx("div",{className:"absolute right-0 top-full mt-2 z-30",children:e.jsx(ns,{onClose:()=>te(!1),onLoadSearch:ve})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>O(!ee),children:[e.jsx(Ke,{className:"w-3.5 h-3.5"})," Save Search"]}),ee&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 z-30 bg-white rounded-xl shadow-xl border border-stone-200 p-4 w-72",children:[e.jsx("p",{className:"text-sm font-medium text-stone-900 mb-2",children:"Save Current Search"}),e.jsx("input",{type:"text",value:M,onChange:s=>U(s.target.value),placeholder:"Name this search...",className:"w-full rounded-lg border border-stone-300 px-3 py-2 text-sm mb-3 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none",onKeyDown:s=>s.key==="Enter"&&le()}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>{O(!1),U("")},children:"Cancel"}),e.jsx(x,{size:"sm",onClick:le,disabled:!M.trim()||ie.isPending,children:"Save"})]})]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>I("list"),className:`p-1.5 rounded-lg transition-colors ${f==="list"?"bg-primary-50 text-primary-600":"text-stone-400 hover:text-stone-600"}`,title:"List view",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("button",{onClick:()=>I("grid"),className:`p-1.5 rounded-lg transition-colors ${f==="grid"?"bg-primary-50 text-primary-600":"text-stone-400 hover:text-stone-600"}`,title:"Grid view",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),e.jsx("button",{onClick:()=>I("map"),className:`p-1.5 rounded-lg transition-colors ${f==="map"?"bg-primary-50 text-primary-600":"text-stone-400 hover:text-stone-600"}`,title:"Map view",children:e.jsx(Be,{className:"w-4 h-4"})})]})]})]})]}),g&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(he,{className:"w-8 h-8 animate-spin text-primary-500"})}),!g&&f==="list"&&e.jsx("div",{className:"space-y-4",children:N.map(s=>{const n=Se(s.start_date),a=z(s.start_date,s.end_date);return e.jsx(F,{hover:!0,onClick:()=>S(s),children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary-50 text-primary-600 flex items-center justify-center shrink-0",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-stone-900",children:s.title}),e.jsx(Qe,{className:"w-4 h-4 text-stone-400 hidden sm:block"})]}),e.jsx("p",{className:"text-sm text-stone-500",children:s.site?.name})]})]}),e.jsx("p",{className:"text-sm text-stone-600 mb-3 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx(o,{variant:"primary",children:s.specialty}),e.jsx(o,{variant:s.cost_type==="free"?"success":"warning",children:s.cost_type==="free"?"Free":`$${s.cost}`}),e.jsx(o,{variant:s.status==="open"?"success":"danger",children:s.status==="open"?"Open":"Filled"}),e.jsxs(o,{variant:"default",children:[a," weeks"]}),n>0&&n<=30&&e.jsxs(o,{variant:"warning",children:["Starts in ",n," days"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-stone-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-3.5 h-3.5"}),s.site?.city,", ",s.site?.state]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"w-3.5 h-3.5"}),new Date(s.start_date).toLocaleDateString()," - ",new Date(s.end_date).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(de,{className:"w-3.5 h-3.5"}),s.filled,"/",s.capacity," spots filled"]}),s.shift_schedule&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"w-3.5 h-3.5"}),s.shift_schedule]}),s.site&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(C,{className:"w-3.5 h-3.5 text-amber-500"}),s.site.rating," (",s.site.review_count," reviews)"]})]})]}),e.jsxs("div",{className:"flex lg:flex-col gap-2 shrink-0",children:[r&&D&&e.jsx("button",{onClick:c=>re(s.id,c),className:"p-2 rounded-xl hover:bg-stone-100 transition-colors self-end",title:y.has(s.id)?"Remove bookmark":"Bookmark",children:e.jsx(q,{className:`w-5 h-5 ${y.has(s.id)?"text-red-500 fill-red-500":"text-stone-400"}`})}),e.jsx(x,{size:"sm",disabled:s.status!=="open",onClick:c=>ce(s,c),children:r?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4"})," Apply"]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4"})," Sign In to Apply"]})}),e.jsx(x,{size:"sm",variant:"outline",onClick:c=>{c.stopPropagation(),S(s)},children:"Details"})]})]})},s.id)})}),!g&&f==="grid"&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4",children:N.map(s=>{const n=z(s.start_date,s.end_date),a=s.capacity-s.filled;return e.jsxs(F,{hover:!0,onClick:()=>S(s),padding:"none",children:[e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary-50 text-primary-600 flex items-center justify-center shrink-0",children:e.jsx(W,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[r&&D&&e.jsx("button",{onClick:c=>re(s.id,c),className:"p-1 rounded-lg hover:bg-stone-100 transition-colors",children:e.jsx(q,{className:`w-4 h-4 ${y.has(s.id)?"text-red-500 fill-red-500":"text-stone-400"}`})}),e.jsx(o,{variant:s.status==="open"?"success":"danger",size:"sm",children:s.status==="open"?`${a} spot${a!==1?"s":""} left`:"Filled"})]})]}),e.jsx("h3",{className:"font-semibold text-stone-900 mb-1 line-clamp-1",children:s.title}),e.jsx("p",{className:"text-sm text-stone-500 mb-2",children:s.site?.name}),e.jsx("p",{className:"text-xs text-stone-500 line-clamp-2 mb-3",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-4",children:[e.jsx(o,{variant:"primary",size:"sm",children:s.specialty}),e.jsx(o,{variant:s.cost_type==="free"?"success":"warning",size:"sm",children:s.cost_type==="free"?"Free":`$${s.cost}`}),e.jsxs(o,{variant:"default",size:"sm",children:[n,"w"]})]}),e.jsxs("div",{className:"space-y-1.5 text-xs text-stone-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(G,{className:"w-3 h-3"}),s.site?.city,", ",s.site?.state]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(H,{className:"w-3 h-3"}),new Date(s.start_date).toLocaleDateString()," - ",new Date(s.end_date).toLocaleDateString()]}),s.site&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(C,{className:"w-3 h-3 text-amber-500"}),e.jsxs("span",{children:[s.site.rating,"/5 (",s.site.review_count," reviews)"]})]})]})]}),e.jsx("div",{className:"border-t border-stone-100 px-5 py-3",children:e.jsx(x,{size:"sm",className:"w-full",disabled:s.status!=="open",onClick:c=>ce(s,c),children:r?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4"})," Apply Now"]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4"})," Sign In to Apply"]})})})]},s.id)})}),!g&&f==="map"&&(()=>{const s={},n=N.map(a=>{const c=a.site?.state?.toUpperCase()||"",V=rs[c];if(!V)return{slot:a,coords:null};const oe=s[c]||0;return s[c]=oe+1,{slot:a,coords:ls(V,oe)}}).filter(a=>a.coords);return e.jsxs("div",{className:"rounded-2xl overflow-hidden border border-stone-200 shadow-sm relative",style:{height:"550px"},children:[e.jsxs(He,{center:[39.8,-98.5],zoom:4,className:"w-full h-full",scrollWheelZoom:!0,children:[e.jsx(We,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),n.map(({slot:a,coords:c})=>e.jsx(Ye,{position:c,icon:cs(a.status==="open",t?.id===a.id),eventHandlers:{click:()=>S(a)},children:e.jsx(qe,{children:e.jsxs("div",{className:"min-w-[200px]",children:[e.jsx("p",{className:"font-semibold text-sm text-stone-900 mb-1",children:a.title}),e.jsxs("p",{className:"text-xs text-stone-500 mb-2",children:[a.site?.name," — ",a.site?.city,", ",a.site?.state]}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[e.jsx("span",{className:"inline-block px-1.5 py-0.5 bg-primary-50 text-primary-700 text-[10px] font-medium rounded",children:a.specialty}),e.jsx("span",{className:`inline-block px-1.5 py-0.5 text-[10px] font-medium rounded ${a.status==="open"?"bg-green-50 text-green-700":"bg-stone-100 text-stone-500"}`,children:a.status==="open"?"Open":"Filled"}),e.jsx("span",{className:`inline-block px-1.5 py-0.5 text-[10px] font-medium rounded ${a.cost_type==="free"?"bg-green-50 text-green-700":"bg-amber-50 text-amber-700"}`,children:a.cost_type==="free"?"Free":`$${a.cost}`})]}),e.jsx("button",{onClick:()=>S(a),className:"text-xs text-primary-600 font-medium hover:underline",children:"View Details →"})]})})},a.id))]}),e.jsx("div",{className:"absolute bottom-4 left-4 z-[1000] bg-white/95 backdrop-blur-sm rounded-lg shadow-md px-3 py-2 text-xs",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500 border-2 border-white shadow-sm"})," Open"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-stone-400 border-2 border-white shadow-sm"})," Filled"]}),e.jsx("span",{className:"text-stone-400",children:"·"}),e.jsxs("span",{className:"text-stone-500",children:[n.length," on map"]})]})})]})})(),N.length===0&&!g&&e.jsxs(F,{className:"text-center py-12",children:[e.jsx(Q,{className:"w-12 h-12 text-stone-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-stone-700 mb-2",children:"No rotations found"}),e.jsx("p",{className:"text-stone-500",children:"Try adjusting your search filters"})]}),e.jsx(Y,{isOpen:pe,onClose:()=>{b(!1),v(null)},title:"Rotation Details",size:"xl",children:t&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary-50 to-secondary-50 rounded-xl p-5",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-white shadow-sm text-primary-600 flex items-center justify-center shrink-0",children:e.jsx(L,{className:"w-7 h-7"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-stone-900",children:t.title}),e.jsx("p",{className:"text-stone-600",children:t.site?.name}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(o,{variant:"primary",size:"md",children:t.specialty}),e.jsx(o,{variant:t.status==="open"?"success":"danger",size:"md",children:t.status==="open"?"Open for Applications":"Filled"}),e.jsx(o,{variant:t.cost_type==="free"?"success":"warning",size:"md",children:t.cost_type==="free"?"No Cost":`$${t.cost}`})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-stone-50 rounded-xl p-3 text-center",children:[e.jsx(H,{className:"w-5 h-5 text-primary-500 mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-stone-500",children:"Duration"}),e.jsxs("p",{className:"font-semibold text-stone-900 text-sm",children:[z(t.start_date,t.end_date)," weeks"]})]}),e.jsxs("div",{className:"bg-stone-50 rounded-xl p-3 text-center",children:[e.jsx(de,{className:"w-5 h-5 text-primary-500 mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-stone-500",children:"Capacity"}),e.jsxs("p",{className:"font-semibold text-stone-900 text-sm",children:[t.filled,"/",t.capacity," filled"]})]}),e.jsxs("div",{className:"bg-stone-50 rounded-xl p-3 text-center",children:[e.jsx(C,{className:"w-5 h-5 text-amber-500 mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-stone-500",children:"Site Rating"}),e.jsxs("p",{className:"font-semibold text-stone-900 text-sm",children:[t.site?.rating||"N/A","/5"]})]}),e.jsxs("div",{className:"bg-stone-50 rounded-xl p-3 text-center",children:[e.jsx(Ze,{className:"w-5 h-5 text-green-500 mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-stone-500",children:"Cost"}),e.jsx("p",{className:"font-semibold text-stone-900 text-sm",children:t.cost_type==="free"?"Free":`$${t.cost}`})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-stone-900 mb-2 flex items-center gap-2",children:[e.jsx(Oe,{className:"w-4 h-4 text-primary-500"})," Description"]}),e.jsx("p",{className:"text-sm text-stone-600 leading-relaxed",children:t.description})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-stone-900 mb-2 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-primary-500"})," Schedule"]}),e.jsxs("div",{className:"bg-stone-50 rounded-xl p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-stone-500",children:"Start Date"}),e.jsx("span",{className:"font-medium text-stone-900",children:new Date(t.start_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-stone-500",children:"End Date"}),e.jsx("span",{className:"font-medium text-stone-900",children:new Date(t.end_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),t.shift_schedule&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-stone-500",children:"Shift Schedule"}),e.jsx("span",{className:"font-medium text-stone-900",children:t.shift_schedule})]})]})]}),t.requirements.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-stone-900 mb-2 flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4 text-primary-500"})," Requirements"]}),e.jsx("div",{className:"space-y-2",children:t.requirements.map(s=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(p,{className:"w-4 h-4 text-green-500 shrink-0"}),e.jsx("span",{className:"text-stone-700",children:s})]},s))})]}),t.site&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-stone-900 mb-2 flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-primary-500"})," Site Information"]}),e.jsxs("div",{className:"bg-stone-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white border border-stone-200 flex items-center justify-center text-primary-600 shrink-0",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-stone-900",children:t.site.name}),t.site.is_verified&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600",children:[e.jsx(p,{className:"w-3 h-3"})," Verified Site"]})]})]}),t.site.description&&e.jsx("p",{className:"text-sm text-stone-600",children:t.site.description}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-stone-600",children:[e.jsx(G,{className:"w-4 h-4 text-stone-400"}),t.site.address,", ",t.site.city,", ",t.site.state," ",t.site.zip]}),t.site.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-stone-600",children:[e.jsx(Xe,{className:"w-4 h-4 text-stone-400"}),t.site.phone]}),t.site.website&&e.jsxs("div",{className:"flex items-center gap-2 text-stone-600",children:[e.jsx(es,{className:"w-4 h-4 text-stone-400"}),e.jsx("span",{className:"text-primary-600 truncate",children:t.site.website})]}),t.site.ehr_system&&e.jsxs("div",{className:"flex items-center gap-2 text-stone-600",children:[e.jsx(W,{className:"w-4 h-4 text-stone-400"}),"EHR: ",t.site.ehr_system]})]}),t.site.specialties&&t.site.specialties.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-stone-500 mb-1.5",children:"Site Specialties"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:t.site.specialties.map(s=>e.jsx(o,{variant:"default",size:"sm",children:s},s))})]}),e.jsx("div",{className:"flex items-center gap-4 pt-1",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{className:"w-4 h-4 text-amber-400 fill-amber-400"}),e.jsx("span",{className:"font-semibold text-stone-900",children:t.site.rating}),e.jsxs("span",{className:"text-sm text-stone-500",children:["(",t.site.review_count," reviews)"]})]})})]})]}),t.preceptor&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-stone-900 mb-2 flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4 text-primary-500"})," Your Preceptor"]}),e.jsxs("div",{className:"flex items-center gap-3 bg-stone-50 rounded-xl p-4",children:[e.jsxs("div",{className:"w-10 h-10 rounded-full bg-primary-100 text-primary-700 flex items-center justify-center font-semibold text-sm",children:[t.preceptor.first_name[0],t.preceptor.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-stone-900",children:[t.preceptor.first_name," ",t.preceptor.last_name]}),e.jsx("p",{className:"text-sm text-stone-500",children:t.preceptor.email})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1.5",children:[e.jsx("span",{className:"text-stone-500",children:"Spots Available"}),e.jsxs("span",{className:"font-medium text-stone-900",children:[t.capacity-t.filled," of ",t.capacity," remaining"]})]}),e.jsx("div",{className:"w-full bg-stone-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${t.filled>=t.capacity?"bg-red-500":t.filled>=t.capacity*.8?"bg-amber-500":"bg-green-500"}`,style:{width:`${t.filled/t.capacity*100}%`}})})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-2 border-t border-stone-200",children:[e.jsxs(x,{variant:"ghost",onClick:()=>{b(!1),v(null)},children:[e.jsx(Ue,{className:"w-4 h-4"})," Back to Search"]}),e.jsx(x,{disabled:t.status!=="open",onClick:()=>{if(!r){l("/login?redirect=/rotations");return}b(!1),j(!0)},children:r?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4"})," Apply for This Rotation"]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4"})," Sign In to Apply"]})})]})]})}),e.jsx(Y,{isOpen:ue,onClose:()=>j(!1),title:"Apply for Rotation",size:"lg",children:t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-primary-50 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold text-primary-900",children:t.title}),e.jsxs("p",{className:"text-sm text-primary-700",children:[t.site?.name," - ",t.site?.city,", ",t.site?.state]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(o,{variant:"primary",size:"sm",children:t.specialty}),e.jsxs(o,{variant:"default",size:"sm",children:[z(t.start_date,t.end_date)," weeks"]}),e.jsxs(o,{variant:"default",size:"sm",children:[new Date(t.start_date).toLocaleDateString()," - ",new Date(t.end_date).toLocaleDateString()]})]})]}),t.requirements.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-stone-700 mb-2",children:"Requirements (ensure you meet these before applying)"}),e.jsx("div",{className:"space-y-1.5",children:t.requirements.map(s=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-stone-600",children:[e.jsx(p,{className:"w-4 h-4 text-green-500 shrink-0"}),s]},s))})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700",children:"Cover Letter / Statement of Interest *"}),e.jsx("textarea",{value:T,onChange:s=>X(s.target.value),rows:6,placeholder:"Tell the site why you're interested in this rotation and what you hope to learn. Include relevant experience and clinical goals...",className:"w-full rounded-xl border border-stone-300 px-4 py-3 text-sm focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none resize-none"}),e.jsxs("p",{className:"text-xs text-stone-400",children:[T.length,"/2000 characters"]})]}),e.jsxs("div",{className:"bg-amber-50 rounded-xl p-3 text-sm text-amber-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Before you apply:"}),e.jsxs("ul",{className:"text-xs space-y-0.5 text-amber-700",children:[e.jsx("li",{children:"- Ensure all your credentials are current in Settings"}),e.jsx("li",{children:"- Review the site requirements above"}),e.jsx("li",{children:"- You'll receive a response within 5-7 business days"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-2",children:[e.jsx(x,{variant:"ghost",onClick:()=>j(!1),children:"Cancel"}),e.jsxs(x,{onClick:ye,isLoading:ne.isPending,children:[e.jsx($,{className:"w-4 h-4"})," Submit Application"]})]})]})}),e.jsx(Y,{isOpen:je,onClose:()=>E(!1),title:"Upgrade Required",size:"md",children:e.jsxs("div",{className:"space-y-4 text-center py-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-amber-100 flex items-center justify-center mx-auto",children:e.jsx(C,{className:"w-8 h-8 text-amber-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-stone-900",children:"Your free trial has ended"}),e.jsx("p",{className:"text-sm text-stone-500 mt-2",children:"You've used your free rotation or your 3-month trial period has expired. Upgrade to Pro for unlimited rotation applications."})]}),e.jsxs("div",{className:"bg-stone-50 rounded-xl p-4 text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-stone-900 mb-2",children:"Pro Plan — $9.99/month"}),e.jsxs("ul",{className:"text-xs text-stone-600 space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-1.5",children:[e.jsx(p,{className:"w-3.5 h-3.5 text-green-500"})," Unlimited rotation applications"]}),e.jsxs("li",{className:"flex items-center gap-1.5",children:[e.jsx(p,{className:"w-3.5 h-3.5 text-green-500"})," Priority application badge"]}),e.jsxs("li",{className:"flex items-center gap-1.5",children:[e.jsx(p,{className:"w-3.5 h-3.5 text-green-500"})," Saved search alerts"]}),e.jsxs("li",{className:"flex items-center gap-1.5",children:[e.jsx(p,{className:"w-3.5 h-3.5 text-green-500"})," Advanced analytics & insights"]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-center pt-2",children:[e.jsx(x,{variant:"ghost",onClick:()=>E(!1),children:"Maybe Later"}),e.jsx(x,{onClick:we,isLoading:ae.isPending,children:"Upgrade to Pro"})]})]})})]})}export{_s as RotationSearch};
