import{c as Me,ak as A,a as te,r as _,G as ke,R as Re,j as e,f as P,aH as Le,aI as Ie,aJ as Fe,p as le,w as D,a7 as De,aK as Te,aL as ze,aM as Ue,af as Be,e as Oe,T as $e,a2 as Qe,aN as He,aO as Ge,aP as Ye,aQ as Ve,N as Ke,M as Xe,aR as We,aS as qe,aT as Ze,x as Je,t as v,aU as es,aV as ss,aW as ts,aX as as,aY as ns,v as rs,l as Y}from"./index-GzcG7CSS.js";import{C as S}from"./Card-FSc1waky.js";import{I as R}from"./Input-B5MQDJHu.js";import{B as F}from"./Badge-9_pL70Ln.js";import{u as is}from"./usePageTitle-CSRQyC0a.js";import{U as ue}from"./user-BvMymkx8.js";import{F as q}from"./file-check-DKQ0yOLY.js";import{C as z}from"./credit-card-ScJuBjZ9.js";import{S as ae}from"./shield-B4OQBYN4.js";import{M as os}from"./mail-BeMqAM3p.js";import{P as ls}from"./phone-D6Tod6__.js";import{S as ne}from"./save-Ba530v52.js";import{P as cs}from"./paperclip-CDP-dEKu.js";import{D as he}from"./download-COygb2Hf.js";import{U as ce}from"./upload-DVvKjw19.js";import{C as Z}from"./circle-check-big-B5eOtT2b.js";import{C as de}from"./circle-alert-DPVkbFxy.js";import{R as ds}from"./refresh-cw-Dmc9F4fM.js";import{E as J}from"./external-link-BMCjof5y.js";import{C as ms}from"./copy-CERpL2dH.js";import{S as us}from"./shield-off-fUO5c9OY.js";const hs=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],W=Me("key",hs);var xs=Object.defineProperty,K=Object.getOwnPropertySymbols,xe=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,me=(i,d,o)=>d in i?xs(i,d,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[d]=o,ee=(i,d)=>{for(var o in d||(d={}))xe.call(d,o)&&me(i,o,d[o]);if(K)for(var o of K(d))fe.call(d,o)&&me(i,o,d[o]);return i},se=(i,d)=>{var o={};for(var u in i)xe.call(i,u)&&d.indexOf(u)<0&&(o[u]=i[u]);if(i!=null&&K)for(var u of K(i))d.indexOf(u)<0&&fe.call(i,u)&&(o[u]=i[u]);return o};var U;(i=>{const d=class y{constructor(s,a,t,n){if(this.version=s,this.errorCorrectionLevel=a,this.modules=[],this.isFunction=[],s<y.MIN_VERSION||s>y.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=s*4+17;let r=[];for(let c=0;c<this.size;c++)r.push(!1);for(let c=0;c<this.size;c++)this.modules.push(r.slice()),this.isFunction.push(r.slice());this.drawFunctionPatterns();const f=this.addEccAndInterleave(t);if(this.drawCodewords(f),n==-1){let c=1e9;for(let m=0;m<8;m++){this.applyMask(m),this.drawFormatBits(m);const l=this.getPenaltyScore();l<c&&(n=m,c=l),this.applyMask(m)}}g(0<=n&&n<=7),this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}static encodeText(s,a){const t=i.QrSegment.makeSegments(s);return y.encodeSegments(t,a)}static encodeBinary(s,a){const t=i.QrSegment.makeBytes(s);return y.encodeSegments([t],a)}static encodeSegments(s,a,t=1,n=40,r=-1,f=!0){if(!(y.MIN_VERSION<=t&&t<=n&&n<=y.MAX_VERSION)||r<-1||r>7)throw new RangeError("Invalid value");let c,m;for(c=t;;c++){const j=y.getNumDataCodewords(c,a)*8,C=x.getTotalBits(s,c);if(C<=j){m=C;break}if(c>=n)throw new RangeError("Data too long")}for(const j of[y.Ecc.MEDIUM,y.Ecc.QUARTILE,y.Ecc.HIGH])f&&m<=y.getNumDataCodewords(c,j)*8&&(a=j);let l=[];for(const j of s){o(j.mode.modeBits,4,l),o(j.numChars,j.mode.numCharCountBits(c),l);for(const C of j.getData())l.push(C)}g(l.length==m);const b=y.getNumDataCodewords(c,a)*8;g(l.length<=b),o(0,Math.min(4,b-l.length),l),o(0,(8-l.length%8)%8,l),g(l.length%8==0);for(let j=236;l.length<b;j^=253)o(j,8,l);let w=[];for(;w.length*8<l.length;)w.push(0);return l.forEach((j,C)=>w[C>>>3]|=j<<7-(C&7)),new y(c,a,w,r)}getModule(s,a){return 0<=s&&s<this.size&&0<=a&&a<this.size&&this.modules[a][s]}getModules(){return this.modules}drawFunctionPatterns(){for(let t=0;t<this.size;t++)this.setFunctionModule(6,t,t%2==0),this.setFunctionModule(t,6,t%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const s=this.getAlignmentPatternPositions(),a=s.length;for(let t=0;t<a;t++)for(let n=0;n<a;n++)t==0&&n==0||t==0&&n==a-1||t==a-1&&n==0||this.drawAlignmentPattern(s[t],s[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(s){const a=this.errorCorrectionLevel.formatBits<<3|s;let t=a;for(let r=0;r<10;r++)t=t<<1^(t>>>9)*1335;const n=(a<<10|t)^21522;g(n>>>15==0);for(let r=0;r<=5;r++)this.setFunctionModule(8,r,u(n,r));this.setFunctionModule(8,7,u(n,6)),this.setFunctionModule(8,8,u(n,7)),this.setFunctionModule(7,8,u(n,8));for(let r=9;r<15;r++)this.setFunctionModule(14-r,8,u(n,r));for(let r=0;r<8;r++)this.setFunctionModule(this.size-1-r,8,u(n,r));for(let r=8;r<15;r++)this.setFunctionModule(8,this.size-15+r,u(n,r));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let s=this.version;for(let t=0;t<12;t++)s=s<<1^(s>>>11)*7973;const a=this.version<<12|s;g(a>>>18==0);for(let t=0;t<18;t++){const n=u(a,t),r=this.size-11+t%3,f=Math.floor(t/3);this.setFunctionModule(r,f,n),this.setFunctionModule(f,r,n)}}drawFinderPattern(s,a){for(let t=-4;t<=4;t++)for(let n=-4;n<=4;n++){const r=Math.max(Math.abs(n),Math.abs(t)),f=s+n,c=a+t;0<=f&&f<this.size&&0<=c&&c<this.size&&this.setFunctionModule(f,c,r!=2&&r!=4)}}drawAlignmentPattern(s,a){for(let t=-2;t<=2;t++)for(let n=-2;n<=2;n++)this.setFunctionModule(s+n,a+t,Math.max(Math.abs(n),Math.abs(t))!=1)}setFunctionModule(s,a,t){this.modules[a][s]=t,this.isFunction[a][s]=!0}addEccAndInterleave(s){const a=this.version,t=this.errorCorrectionLevel;if(s.length!=y.getNumDataCodewords(a,t))throw new RangeError("Invalid argument");const n=y.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][a],r=y.ECC_CODEWORDS_PER_BLOCK[t.ordinal][a],f=Math.floor(y.getNumRawDataModules(a)/8),c=n-f%n,m=Math.floor(f/n);let l=[];const b=y.reedSolomonComputeDivisor(r);for(let j=0,C=0;j<n;j++){let M=s.slice(C,C+m-r+(j<c?0:1));C+=M.length;const B=y.reedSolomonComputeRemainder(M,b);j<c&&M.push(0),l.push(M.concat(B))}let w=[];for(let j=0;j<l[0].length;j++)l.forEach((C,M)=>{(j!=m-r||M>=c)&&w.push(C[j])});return g(w.length==f),w}drawCodewords(s){if(s.length!=Math.floor(y.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let a=0;for(let t=this.size-1;t>=1;t-=2){t==6&&(t=5);for(let n=0;n<this.size;n++)for(let r=0;r<2;r++){const f=t-r,m=(t+1&2)==0?this.size-1-n:n;!this.isFunction[m][f]&&a<s.length*8&&(this.modules[m][f]=u(s[a>>>3],7-(a&7)),a++)}}g(a==s.length*8)}applyMask(s){if(s<0||s>7)throw new RangeError("Mask value out of range");for(let a=0;a<this.size;a++)for(let t=0;t<this.size;t++){let n;switch(s){case 0:n=(t+a)%2==0;break;case 1:n=a%2==0;break;case 2:n=t%3==0;break;case 3:n=(t+a)%3==0;break;case 4:n=(Math.floor(t/3)+Math.floor(a/2))%2==0;break;case 5:n=t*a%2+t*a%3==0;break;case 6:n=(t*a%2+t*a%3)%2==0;break;case 7:n=((t+a)%2+t*a%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[a][t]&&n&&(this.modules[a][t]=!this.modules[a][t])}}getPenaltyScore(){let s=0;for(let r=0;r<this.size;r++){let f=!1,c=0,m=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[r][l]==f?(c++,c==5?s+=y.PENALTY_N1:c>5&&s++):(this.finderPenaltyAddHistory(c,m),f||(s+=this.finderPenaltyCountPatterns(m)*y.PENALTY_N3),f=this.modules[r][l],c=1);s+=this.finderPenaltyTerminateAndCount(f,c,m)*y.PENALTY_N3}for(let r=0;r<this.size;r++){let f=!1,c=0,m=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[l][r]==f?(c++,c==5?s+=y.PENALTY_N1:c>5&&s++):(this.finderPenaltyAddHistory(c,m),f||(s+=this.finderPenaltyCountPatterns(m)*y.PENALTY_N3),f=this.modules[l][r],c=1);s+=this.finderPenaltyTerminateAndCount(f,c,m)*y.PENALTY_N3}for(let r=0;r<this.size-1;r++)for(let f=0;f<this.size-1;f++){const c=this.modules[r][f];c==this.modules[r][f+1]&&c==this.modules[r+1][f]&&c==this.modules[r+1][f+1]&&(s+=y.PENALTY_N2)}let a=0;for(const r of this.modules)a=r.reduce((f,c)=>f+(c?1:0),a);const t=this.size*this.size,n=Math.ceil(Math.abs(a*20-t*10)/t)-1;return g(0<=n&&n<=9),s+=n*y.PENALTY_N4,g(0<=s&&s<=2568888),s}getAlignmentPatternPositions(){if(this.version==1)return[];{const s=Math.floor(this.version/7)+2,a=this.version==32?26:Math.ceil((this.version*4+4)/(s*2-2))*2;let t=[6];for(let n=this.size-7;t.length<s;n-=a)t.splice(1,0,n);return t}}static getNumRawDataModules(s){if(s<y.MIN_VERSION||s>y.MAX_VERSION)throw new RangeError("Version number out of range");let a=(16*s+128)*s+64;if(s>=2){const t=Math.floor(s/7)+2;a-=(25*t-10)*t-55,s>=7&&(a-=36)}return g(208<=a&&a<=29648),a}static getNumDataCodewords(s,a){return Math.floor(y.getNumRawDataModules(s)/8)-y.ECC_CODEWORDS_PER_BLOCK[a.ordinal][s]*y.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][s]}static reedSolomonComputeDivisor(s){if(s<1||s>255)throw new RangeError("Degree out of range");let a=[];for(let n=0;n<s-1;n++)a.push(0);a.push(1);let t=1;for(let n=0;n<s;n++){for(let r=0;r<a.length;r++)a[r]=y.reedSolomonMultiply(a[r],t),r+1<a.length&&(a[r]^=a[r+1]);t=y.reedSolomonMultiply(t,2)}return a}static reedSolomonComputeRemainder(s,a){let t=a.map(n=>0);for(const n of s){const r=n^t.shift();t.push(0),a.forEach((f,c)=>t[c]^=y.reedSolomonMultiply(f,r))}return t}static reedSolomonMultiply(s,a){if(s>>>8||a>>>8)throw new RangeError("Byte out of range");let t=0;for(let n=7;n>=0;n--)t=t<<1^(t>>>7)*285,t^=(a>>>n&1)*s;return g(t>>>8==0),t}finderPenaltyCountPatterns(s){const a=s[1];g(a<=this.size*3);const t=a>0&&s[2]==a&&s[3]==a*3&&s[4]==a&&s[5]==a;return(t&&s[0]>=a*4&&s[6]>=a?1:0)+(t&&s[6]>=a*4&&s[0]>=a?1:0)}finderPenaltyTerminateAndCount(s,a,t){return s&&(this.finderPenaltyAddHistory(a,t),a=0),a+=this.size,this.finderPenaltyAddHistory(a,t),this.finderPenaltyCountPatterns(t)}finderPenaltyAddHistory(s,a){a[0]==0&&(s+=this.size),a.pop(),a.unshift(s)}};d.MIN_VERSION=1,d.MAX_VERSION=40,d.PENALTY_N1=3,d.PENALTY_N2=3,d.PENALTY_N3=40,d.PENALTY_N4=10,d.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],d.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],i.QrCode=d;function o(p,s,a){if(s<0||s>31||p>>>s)throw new RangeError("Value out of range");for(let t=s-1;t>=0;t--)a.push(p>>>t&1)}function u(p,s){return(p>>>s&1)!=0}function g(p){if(!p)throw new Error("Assertion error")}const h=class E{constructor(s,a,t){if(this.mode=s,this.numChars=a,this.bitData=t,a<0)throw new RangeError("Invalid argument");this.bitData=t.slice()}static makeBytes(s){let a=[];for(const t of s)o(t,8,a);return new E(E.Mode.BYTE,s.length,a)}static makeNumeric(s){if(!E.isNumeric(s))throw new RangeError("String contains non-numeric characters");let a=[];for(let t=0;t<s.length;){const n=Math.min(s.length-t,3);o(parseInt(s.substring(t,t+n),10),n*3+1,a),t+=n}return new E(E.Mode.NUMERIC,s.length,a)}static makeAlphanumeric(s){if(!E.isAlphanumeric(s))throw new RangeError("String contains unencodable characters in alphanumeric mode");let a=[],t;for(t=0;t+2<=s.length;t+=2){let n=E.ALPHANUMERIC_CHARSET.indexOf(s.charAt(t))*45;n+=E.ALPHANUMERIC_CHARSET.indexOf(s.charAt(t+1)),o(n,11,a)}return t<s.length&&o(E.ALPHANUMERIC_CHARSET.indexOf(s.charAt(t)),6,a),new E(E.Mode.ALPHANUMERIC,s.length,a)}static makeSegments(s){return s==""?[]:E.isNumeric(s)?[E.makeNumeric(s)]:E.isAlphanumeric(s)?[E.makeAlphanumeric(s)]:[E.makeBytes(E.toUtf8ByteArray(s))]}static makeEci(s){let a=[];if(s<0)throw new RangeError("ECI assignment value out of range");if(s<128)o(s,8,a);else if(s<16384)o(2,2,a),o(s,14,a);else if(s<1e6)o(6,3,a),o(s,21,a);else throw new RangeError("ECI assignment value out of range");return new E(E.Mode.ECI,0,a)}static isNumeric(s){return E.NUMERIC_REGEX.test(s)}static isAlphanumeric(s){return E.ALPHANUMERIC_REGEX.test(s)}getData(){return this.bitData.slice()}static getTotalBits(s,a){let t=0;for(const n of s){const r=n.mode.numCharCountBits(a);if(n.numChars>=1<<r)return 1/0;t+=4+r+n.bitData.length}return t}static toUtf8ByteArray(s){s=encodeURI(s);let a=[];for(let t=0;t<s.length;t++)s.charAt(t)!="%"?a.push(s.charCodeAt(t)):(a.push(parseInt(s.substring(t+1,t+3),16)),t+=2);return a}};h.NUMERIC_REGEX=/^[0-9]*$/,h.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,h.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let x=h;i.QrSegment=h})(U||(U={}));(i=>{(d=>{const o=class{constructor(g,h){this.ordinal=g,this.formatBits=h}};o.LOW=new o(0,1),o.MEDIUM=new o(1,0),o.QUARTILE=new o(2,3),o.HIGH=new o(3,2),d.Ecc=o})(i.QrCode||(i.QrCode={}))})(U||(U={}));(i=>{(d=>{const o=class{constructor(g,h){this.modeBits=g,this.numBitsCharCount=h}numCharCountBits(g){return this.numBitsCharCount[Math.floor((g+7)/17)]}};o.NUMERIC=new o(1,[10,12,14]),o.ALPHANUMERIC=new o(2,[9,11,13]),o.BYTE=new o(4,[8,16,16]),o.KANJI=new o(8,[8,10,12]),o.ECI=new o(7,[0,0,0]),d.Mode=o})(i.QrSegment||(i.QrSegment={}))})(U||(U={}));var $=U;var fs={L:$.QrCode.Ecc.LOW,M:$.QrCode.Ecc.MEDIUM,Q:$.QrCode.Ecc.QUARTILE,H:$.QrCode.Ecc.HIGH},pe=128,ge="L",je="#FFFFFF",ye="#000000",be=!1,Ne=1,ps=4,gs=0,js=.1;function ve(i,d=0){const o=[];return i.forEach(function(u,g){let h=null;u.forEach(function(x,p){if(!x&&h!==null){o.push(`M${h+d} ${g+d}h${p-h}v1H${h+d}z`),h=null;return}if(p===u.length-1){if(!x)return;h===null?o.push(`M${p+d},${g+d} h1v1H${p+d}z`):o.push(`M${h+d},${g+d} h${p+1-h}v1H${h+d}z`);return}x&&h===null&&(h=p)})}),o.join("")}function we(i,d){return i.slice().map((o,u)=>u<d.y||u>=d.y+d.h?o:o.map((g,h)=>h<d.x||h>=d.x+d.w?g:!1))}function ys(i,d,o,u){if(u==null)return null;const g=i.length+o*2,h=Math.floor(d*js),x=g/d,p=(u.width||h)*x,s=(u.height||h)*x,a=u.x==null?i.length/2-p/2:u.x*x,t=u.y==null?i.length/2-s/2:u.y*x,n=u.opacity==null?1:u.opacity;let r=null;if(u.excavate){let c=Math.floor(a),m=Math.floor(t),l=Math.ceil(p+a-c),b=Math.ceil(s+t-m);r={x:c,y:m,w:l,h:b}}const f=u.crossOrigin;return{x:a,y:t,h:s,w:p,excavation:r,opacity:n,crossOrigin:f}}function bs(i,d){return d!=null?Math.max(Math.floor(d),0):i?ps:gs}function Ce({value:i,level:d,minVersion:o,includeMargin:u,marginSize:g,imageSettings:h,size:x,boostLevel:p}){let s=A.useMemo(()=>{const c=(Array.isArray(i)?i:[i]).reduce((m,l)=>(m.push(...$.QrSegment.makeSegments(l)),m),[]);return $.QrCode.encodeSegments(c,fs[d],o,void 0,void 0,p)},[i,d,o,p]);const{cells:a,margin:t,numCells:n,calculatedImageSettings:r}=A.useMemo(()=>{let f=s.getModules();const c=bs(u,g),m=f.length+c*2,l=ys(f,x,c,h);return{cells:f,margin:c,numCells:m,calculatedImageSettings:l}},[s,x,h,u,g]);return{qrcode:s,margin:t,cells:a,numCells:n,calculatedImageSettings:r}}var Ns=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),vs=A.forwardRef(function(d,o){const u=d,{value:g,size:h=pe,level:x=ge,bgColor:p=je,fgColor:s=ye,includeMargin:a=be,minVersion:t=Ne,boostLevel:n,marginSize:r,imageSettings:f}=u,m=se(u,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:l}=m,b=se(m,["style"]),w=f?.src,j=A.useRef(null),C=A.useRef(null),M=A.useCallback(I=>{j.current=I,typeof o=="function"?o(I):o&&(o.current=I)},[o]),[B,V]=A.useState(!1),{margin:T,cells:Q,numCells:H,calculatedImageSettings:k}=Ce({value:g,level:x,minVersion:t,boostLevel:n,includeMargin:a,marginSize:r,imageSettings:f,size:h});A.useEffect(()=>{if(j.current!=null){const I=j.current,L=I.getContext("2d");if(!L)return;let O=Q;const G=C.current,re=k!=null&&G!==null&&G.complete&&G.naturalHeight!==0&&G.naturalWidth!==0;re&&k.excavation!=null&&(O=we(Q,k.excavation));const ie=window.devicePixelRatio||1;I.height=I.width=h*ie;const oe=h/H*ie;L.scale(oe,oe),L.fillStyle=p,L.fillRect(0,0,H,H),L.fillStyle=s,Ns?L.fill(new Path2D(ve(O,T))):Q.forEach(function(Pe,Se){Pe.forEach(function(Ae,_e){Ae&&L.fillRect(_e+T,Se+T,1,1)})}),k&&(L.globalAlpha=k.opacity),re&&L.drawImage(G,k.x+T,k.y+T,k.w,k.h)}}),A.useEffect(()=>{V(!1)},[w]);const X=ee({height:h,width:h},l);let N=null;return w!=null&&(N=A.createElement("img",{src:w,key:w,style:{display:"none"},onLoad:()=>{V(!0)},ref:C,crossOrigin:k?.crossOrigin})),A.createElement(A.Fragment,null,A.createElement("canvas",ee({style:X,height:h,width:h,ref:M,role:"img"},b)),N)});vs.displayName="QRCodeCanvas";var Ee=A.forwardRef(function(d,o){const u=d,{value:g,size:h=pe,level:x=ge,bgColor:p=je,fgColor:s=ye,includeMargin:a=be,minVersion:t=Ne,boostLevel:n,title:r,marginSize:f,imageSettings:c}=u,m=se(u,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:l,cells:b,numCells:w,calculatedImageSettings:j}=Ce({value:g,level:x,minVersion:t,boostLevel:n,includeMargin:a,marginSize:f,imageSettings:c,size:h});let C=b,M=null;c!=null&&j!=null&&(j.excavation!=null&&(C=we(b,j.excavation)),M=A.createElement("image",{href:c.src,height:j.h,width:j.w,x:j.x+l,y:j.y+l,preserveAspectRatio:"none",opacity:j.opacity,crossOrigin:j.crossOrigin}));const B=ve(C,l);return A.createElement("svg",ee({height:h,width:h,viewBox:`0 0 ${w} ${w}`,ref:o,role:"img"},m),!!r&&A.createElement("title",null,r),A.createElement("path",{fill:p,d:`M0,0 h${w}v${w}H0z`,shapeRendering:"crispEdges"}),A.createElement("path",{fill:s,d:B,shapeRendering:"crispEdges"}),M)});Ee.displayName="QRCodeSVG";const ws=[{key:"profile",label:"Profile",icon:ue},{key:"academic",label:"Academic",icon:ke,roles:["student"]},{key:"credentials",label:"Credentials",icon:q,roles:["student"]},{key:"payments",label:"Payments",icon:z,roles:["site_manager"]},{key:"subscription",label:"Subscription",icon:z,roles:["student"]},{key:"security",label:"Security",icon:ae},{key:"notifications",label:"Notifications",icon:Re}],Cs=["Emergency Medicine","Family Practice","Internal Medicine","Pediatrics","OB/GYN","Surgery","Orthopedics","Cardiology","Neurology","Psychiatry","Dermatology","Oncology","ICU/Critical Care","Geriatrics","Physical Therapy","Social Work","Urgent Care","Rehabilitation","Community Health","Telehealth"];function tt(){is("Settings");const{user:i}=te(),o=new URLSearchParams(window.location.search).get("tab")||"profile",[u,g]=_.useState(o),h=ws.filter(x=>!x.roles||x.roles.includes(i?.role||""));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-stone-900",children:"Settings"}),e.jsx("p",{className:"text-stone-500",children:"Manage your account and preferences"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:"lg:w-56 shrink-0",children:e.jsx(S,{padding:"sm",children:e.jsx("nav",{className:"flex lg:flex-col gap-1 overflow-x-auto",children:h.map(x=>{const p=x.icon;return e.jsxs("button",{onClick:()=>g(x.key),className:`flex items-center gap-2.5 px-3 py-2.5 rounded-xl text-sm font-medium transition-all whitespace-nowrap ${u===x.key?"bg-primary-50 text-primary-700":"text-stone-600 hover:bg-stone-50"}`,children:[e.jsx(p,{className:"w-4 h-4 shrink-0"}),x.label]},x.key)})})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[u==="profile"&&e.jsx(Es,{}),u==="academic"&&e.jsx(Ps,{}),u==="credentials"&&e.jsx(Ss,{}),u==="payments"&&e.jsx(Ms,{}),u==="subscription"&&e.jsx(ks,{}),u==="security"&&e.jsx(As,{}),u==="notifications"&&e.jsx(Rs,{})]})]})]})}function Es(){const{user:i}=te(),[d,o]=_.useState({first_name:i?.firstName||"",last_name:i?.lastName||"",phone:i?.phone||""}),[u,g]=_.useState(!1),h=async()=>{g(!0);try{await Je.updateProfile(d),v.success("Profile updated successfully")}catch(p){const s=p instanceof Error?p.message:"Failed to update profile";v.error(s)}finally{g(!1)}},x=`${i?.firstName?.charAt(0)||""}${i?.lastName?.charAt(0)||""}`.toUpperCase();return e.jsxs(S,{children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-900 mb-6",children:"Personal Information"}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-primary-400 to-secondary-500 flex items-center justify-center text-white text-xl font-bold",children:x}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-stone-900",children:[i?.firstName," ",i?.lastName]}),e.jsx(F,{variant:"primary",children:i?.role?.replace("_"," ")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(R,{label:"First Name",value:d.first_name,onChange:p=>o({...d,first_name:p.target.value}),icon:e.jsx(ue,{className:"w-4 h-4"})}),e.jsx(R,{label:"Last Name",value:d.last_name,onChange:p=>o({...d,last_name:p.target.value})})]}),e.jsx(R,{label:"Email",type:"email",value:i?.email||"",disabled:!0,icon:e.jsx(os,{className:"w-4 h-4"})}),e.jsx(R,{label:"Phone",type:"tel",placeholder:"(555) 123-4567",value:d.phone,onChange:p=>o({...d,phone:p.target.value}),icon:e.jsx(ls,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs(P,{onClick:h,isLoading:u,children:[e.jsx(ne,{className:"w-4 h-4"})," Save Changes"]})})]})]})}function Ps(){const{data:i,isLoading:d}=Le(),o=Ie(),{data:u}=Fe(),g=u?.data||[],h=i?.profile,[x,p]=_.useState({university_id:"",program_id:"",bio:"",graduation_date:"",gpa:"",clinical_interests:[]}),[s,a]=_.useState([]),[t,n]=_.useState(!1);h&&!t&&(p({university_id:h.university_id||"",program_id:h.program_id||"",bio:h.bio||"",graduation_date:h.graduation_date||"",gpa:h.gpa?String(h.gpa):"",clinical_interests:h.clinical_interests||[]}),h.university_id&&le.programs(h.university_id).then(a),n(!0));const r=async m=>{if(p(l=>({...l,university_id:m,program_id:""})),a([]),m){const l=await le.programs(m);a(l)}},f=m=>{p(l=>({...l,clinical_interests:l.clinical_interests.includes(m)?l.clinical_interests.filter(b=>b!==m):[...l.clinical_interests,m]}))},c=async()=>{try{await o.mutateAsync({university_id:x.university_id||null,program_id:x.program_id||null,bio:x.bio||null,graduation_date:x.graduation_date||null,gpa:x.gpa?parseFloat(x.gpa):null,clinical_interests:x.clinical_interests}),v.success("Academic info updated")}catch(m){const l=m instanceof Error?m.message:"Failed to update";v.error(l)}};return d?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(D,{className:"w-8 h-8 animate-spin text-primary-500"})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-900 mb-6",children:"Academic Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700",children:"University"}),e.jsxs("select",{value:x.university_id,onChange:m=>r(m.target.value),className:"w-full rounded-xl border border-stone-300 px-4 py-2.5 text-sm bg-white focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select university..."}),g.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700",children:"Program"}),e.jsxs("select",{value:x.program_id,onChange:m=>p(l=>({...l,program_id:m.target.value})),className:"w-full rounded-xl border border-stone-300 px-4 py-2.5 text-sm bg-white focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none",disabled:!x.university_id,children:[e.jsx("option",{value:"",children:x.university_id?"Select program...":"Select university first"}),s.map(m=>e.jsxs("option",{value:m.id,children:[m.name," (",m.degree_type,") - ",m.required_hours,"h required"]},m.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(R,{label:"Expected Graduation",type:"date",value:x.graduation_date,onChange:m=>p({...x,graduation_date:m.target.value})}),e.jsx(R,{label:"GPA",type:"number",step:"0.01",min:"0",max:"4.0",placeholder:"3.50",value:x.gpa,onChange:m=>p({...x,gpa:m.target.value})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700",children:"Bio"}),e.jsx("textarea",{value:x.bio,onChange:m=>p({...x,bio:m.target.value}),rows:3,placeholder:"Tell preceptors about yourself...",className:"w-full rounded-xl border border-stone-300 px-4 py-3 text-sm focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none resize-none"})]})]})]}),e.jsxs(S,{children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-900 mb-4",children:"Clinical Interests"}),e.jsx("p",{className:"text-sm text-stone-500 mb-4",children:"Select the specialties you're interested in"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Cs.map(m=>e.jsx("button",{onClick:()=>f(m),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${x.clinical_interests.includes(m)?"bg-primary-500 text-white":"bg-stone-100 text-stone-600 hover:bg-stone-200"}`,children:m},m))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(P,{onClick:c,isLoading:o.isPending,children:[e.jsx(ne,{className:"w-4 h-4"})," Save Academic Info"]})})]})}function Ss(){const{data:i,isLoading:d}=De(),o=Te(),u=ze(),g=Ue(),[h,x]=_.useState(!1),[p,s]=_.useState({type:"cpr",name:"",expiration_date:""}),a=new Map,t=i?.credentials||[],n=async()=>{if(!p.name){v.error("Please enter a credential name");return}try{await o.mutateAsync({type:p.type,name:p.name,expiration_date:p.expiration_date||null,status:"pending"}),v.success("Credential added"),x(!1),s({type:"cpr",name:"",expiration_date:""})}catch(l){const b=l instanceof Error?l.message:"Failed to add";v.error(b)}},r=async l=>{try{await u.mutateAsync(l),v.success("Credential removed")}catch(b){const w=b instanceof Error?b.message:"Failed to remove";v.error(w)}},f=async(l,b)=>{if(b.size>20971520){v.error("File too large. Maximum size is 20MB.");return}try{await g.mutateAsync({id:l,file:b}),v.success("Document uploaded successfully")}catch(j){const C=j instanceof Error?j.message:"Failed to upload";v.error(C)}},c=l=>{switch(l){case"valid":return"success";case"expiring_soon":return"warning";case"expired":return"danger";default:return"default"}},m=l=>l<1024?l+" B":l<1024*1024?(l/1024).toFixed(1)+" KB":(l/(1024*1024)).toFixed(1)+" MB";return d?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(D,{className:"w-8 h-8 animate-spin text-primary-500"})})}):e.jsx("div",{className:"space-y-6",children:e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-900",children:"Credentials & Documents"}),e.jsx("p",{className:"text-sm text-stone-500",children:"Manage your clinical credentials and upload supporting documents"})]}),e.jsxs(P,{size:"sm",onClick:()=>x(!h),children:[e.jsx(Be,{className:"w-4 h-4"})," Add"]})]}),h&&e.jsxs("div",{className:"bg-stone-50 rounded-xl p-4 mb-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700",children:"Type"}),e.jsxs("select",{value:p.type,onChange:l=>s({...p,type:l.target.value}),className:"w-full rounded-xl border border-stone-300 px-3 py-2.5 text-sm bg-white focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none",children:[e.jsx("option",{value:"cpr",children:"CPR/BLS"}),e.jsx("option",{value:"background_check",children:"Background Check"}),e.jsx("option",{value:"immunization",children:"Immunization Records"}),e.jsx("option",{value:"liability_insurance",children:"Liability Insurance"}),e.jsx("option",{value:"drug_screen",children:"Drug Screen"}),e.jsx("option",{value:"license",children:"License/Certification"}),e.jsx("option",{value:"hipaa",children:"HIPAA Training"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsx(R,{label:"Name",placeholder:"e.g. BLS Certification",value:p.name,onChange:l=>s({...p,name:l.target.value})}),e.jsx(R,{label:"Expiration Date",type:"date",value:p.expiration_date,onChange:l=>s({...p,expiration_date:l.target.value})})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>x(!1),children:"Cancel"}),e.jsx(P,{size:"sm",onClick:n,isLoading:o.isPending,children:"Add Credential"})]})]}),e.jsxs("div",{className:"space-y-3",children:[t.length===0&&e.jsxs("div",{className:"text-center py-8 text-stone-400",children:[e.jsx(q,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No credentials added yet"})]}),t.map(l=>e.jsxs("div",{className:"p-4 rounded-xl border border-stone-200 hover:border-stone-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary-50 text-primary-600 flex items-center justify-center shrink-0",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-stone-900 text-sm",children:l.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("span",{className:"text-xs text-stone-500 capitalize",children:l.type.replace("_"," ")}),l.expiration_date&&e.jsxs("span",{className:"text-xs text-stone-400 flex items-center gap-1",children:[e.jsx(Oe,{className:"w-3 h-3"}),"Exp: ",new Date(l.expiration_date).toLocaleDateString()]})]})]}),e.jsx(F,{variant:c(l.status),children:l.status.replace("_"," ")}),e.jsx("button",{onClick:()=>r(l.id),className:"p-1.5 rounded-lg hover:bg-red-50 text-stone-400 hover:text-red-500 transition-colors",children:e.jsx($e,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"mt-3 ml-14",children:[l.file_name?e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(cs,{className:"w-3.5 h-3.5 text-stone-400"}),e.jsx("span",{className:"text-stone-600 truncate",children:l.file_name}),l.file_size&&e.jsxs("span",{className:"text-xs text-stone-400",children:["(",m(l.file_size),")"]}),e.jsxs("a",{href:Qe.downloadCredentialUrl(l.id),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-primary-600 hover:text-primary-700 font-medium ml-1",children:[e.jsx(he,{className:"w-3 h-3"})," Download"]}),e.jsxs("button",{onClick:()=>a.get(l.id)?.click(),className:"inline-flex items-center gap-1 text-xs text-stone-500 hover:text-stone-700 font-medium ml-1",children:[e.jsx(ce,{className:"w-3 h-3"})," Replace"]})]}):e.jsxs("button",{onClick:()=>a.get(l.id)?.click(),disabled:g.isPending,className:"inline-flex items-center gap-1.5 text-xs text-primary-600 hover:text-primary-700 font-medium py-1 px-2 rounded-lg hover:bg-primary-50 transition-colors disabled:opacity-50",children:[g.isPending?e.jsx(D,{className:"w-3 h-3 animate-spin"}):e.jsx(ce,{className:"w-3 h-3"}),"Upload Document"]}),e.jsx("input",{ref:b=>{b&&a.set(l.id,b)},type:"file",accept:".pdf,.jpg,.jpeg,.png,.doc,.docx",className:"hidden",onChange:b=>{b.target.files?.[0]&&(f(l.id,b.target.files[0]),b.target.value="")}})]})]},l.id))]})]})})}function As(){const[i,d]=_.useState({current:"",newPass:"",confirm:""}),[o,u]=_.useState(!1),g=async()=>{if(i.newPass!==i.confirm){v.error("Passwords do not match");return}if(i.newPass.length<8){v.error("Password must be at least 8 characters");return}u(!0);try{await new Promise(h=>setTimeout(h,1e3)),v.success("Password updated successfully"),d({current:"",newPass:"",confirm:""})}catch{v.error("Failed to update password")}finally{u(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-900 mb-6",children:"Change Password"}),e.jsxs("div",{className:"space-y-4 max-w-md",children:[e.jsx(R,{label:"Current Password",type:"password",value:i.current,onChange:h=>d({...i,current:h.target.value}),placeholder:"Enter current password"}),e.jsx(R,{label:"New Password",type:"password",value:i.newPass,onChange:h=>d({...i,newPass:h.target.value}),placeholder:"Enter new password (min 8 chars)"}),e.jsx(R,{label:"Confirm New Password",type:"password",value:i.confirm,onChange:h=>d({...i,confirm:h.target.value}),placeholder:"Confirm new password"}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs(P,{onClick:g,isLoading:o,children:[e.jsx(ae,{className:"w-4 h-4"})," Update Password"]})})]})]}),e.jsx(_s,{})]})}function _s(){const{data:i,isLoading:d}=es(),o=ss(),u=ts(),g=as(),h=ns(),[x,p]=_.useState(null),[s,a]=_.useState(""),[t,n]=_.useState(null),[r,f]=_.useState(""),[c,m]=_.useState(!1),[l,b]=_.useState(!1),[w,j]=_.useState(""),[C,M]=_.useState(!1),B=i?.mfa_enabled??!1,V=async()=>{try{const N=await o.mutateAsync();p(N),a(""),n(null)}catch(N){v.error(N.message||"Failed to initiate MFA setup.")}},T=async()=>{if(s.length!==6){v.error("Please enter a 6-digit code");return}try{const N=await u.mutateAsync(s);v.success(N.message),n(N.backup_codes),p(null),a("")}catch(N){v.error(N.message||"Invalid code.")}},Q=async()=>{try{const N=await g.mutateAsync(r);v.success(N.message),m(!1),f(""),n(null)}catch(N){v.error(N.message||"Failed to disable MFA.")}},H=async()=>{try{const N=await h.mutateAsync(w);v.success(N.message),n(N.backup_codes),b(!1),j("")}catch(N){v.error(N.message||"Failed to regenerate backup codes.")}},k=()=>{t&&(navigator.clipboard.writeText(t.join(`
`)),M(!0),setTimeout(()=>M(!1),2e3))},X=()=>{if(!t)return;const N=`ClinicLink Backup Codes
${"=".repeat(30)}

${t.join(`
`)}

Keep these codes in a safe place.
Each code can only be used once.`,I=new Blob([N],{type:"text/plain"}),L=URL.createObjectURL(I),O=document.createElement("a");O.href=L,O.download="cliniclink-backup-codes.txt",O.click(),URL.revokeObjectURL(L)};return d?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(D,{className:"w-6 h-6 animate-spin text-primary-500"})})}):t?e.jsxs(S,{children:[e.jsxs("h2",{className:"text-lg font-semibold text-stone-900 mb-2 flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5 text-primary-500"})," Backup Codes"]}),e.jsx("p",{className:"text-sm text-stone-500 mb-4",children:"Save these codes in a safe place. Each code can only be used once to sign in if you lose access to your authenticator app."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-w-sm mb-4",children:t.map((N,I)=>e.jsx("code",{className:"px-3 py-2 bg-stone-100 rounded-lg text-sm font-mono text-stone-900 text-center",children:N},I))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:k,children:[C?e.jsx(rs,{className:"w-4 h-4"}):e.jsx(ms,{className:"w-4 h-4"}),C?"Copied":"Copy All"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:X,children:[e.jsx(he,{className:"w-4 h-4"})," Download"]}),e.jsx(P,{size:"sm",onClick:()=>n(null),children:"Done"})]})]}):x?e.jsxs(S,{children:[e.jsxs("h2",{className:"text-lg font-semibold text-stone-900 mb-2 flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-primary-500"})," Set Up Two-Factor Authentication"]}),e.jsx("p",{className:"text-sm text-stone-500 mb-4",children:"Scan the QR code below with your authenticator app (Google Authenticator, Authy, etc.), then enter the 6-digit code to verify."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-start",children:[e.jsx("div",{className:"bg-white p-4 rounded-xl border border-stone-200 shrink-0",children:e.jsx(Ee,{value:x.qr_code_url,size:180})}),e.jsxs("div",{className:"space-y-4 flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-stone-500 mb-1",children:"Manual entry key"}),e.jsx("code",{className:"block px-3 py-2 bg-stone-100 rounded-lg text-sm font-mono text-stone-900 break-all select-all",children:x.secret})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Verification Code"}),e.jsx("input",{type:"text",inputMode:"numeric",maxLength:6,value:s,onChange:N=>a(N.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"w-full max-w-[200px] rounded-xl border border-stone-300 bg-white px-4 py-2.5 text-lg font-mono tracking-widest text-center focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 focus:outline-none"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{onClick:T,isLoading:u.isPending,disabled:s.length!==6,children:[e.jsx(Y,{className:"w-4 h-4"})," Verify & Enable"]}),e.jsx(P,{variant:"outline",onClick:()=>p(null),children:"Cancel"})]})]})]})]}):B?e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-stone-900 flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-green-500"})," Two-Factor Authentication"]}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:"Your account is protected with 2FA."})]}),e.jsx(F,{variant:"success",children:"Enabled"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-stone-50 rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-stone-900",children:"Authenticator App"}),e.jsxs("p",{className:"text-xs text-stone-500",children:["Enabled ",i?.mfa_confirmed_at?new Date(i.mfa_confirmed_at).toLocaleDateString():""]})]}),e.jsx(F,{variant:"success",size:"sm",children:"Active"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-stone-50 rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-stone-900",children:"Backup Codes"}),e.jsxs("p",{className:"text-xs text-stone-500",children:[i?.backup_codes_remaining??0," codes remaining"]})]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>b(!0),children:[e.jsx(W,{className:"w-4 h-4"})," Regenerate"]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-stone-200",children:e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>m(!0),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(us,{className:"w-4 h-4"})," Disable 2FA"]})}),c&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 rounded-xl space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-red-900",children:"Confirm your password to disable 2FA"}),e.jsx(R,{type:"password",value:r,onChange:N=>f(N.target.value),placeholder:"Enter your password"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"danger",size:"sm",onClick:Q,isLoading:g.isPending,children:"Disable 2FA"}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>{m(!1),f("")},children:"Cancel"})]})]}),l&&e.jsxs("div",{className:"mt-4 p-4 bg-amber-50 rounded-xl space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-amber-900",children:"Confirm your password to regenerate backup codes"}),e.jsx("p",{className:"text-xs text-amber-700",children:"This will invalidate all existing backup codes."}),e.jsx(R,{type:"password",value:w,onChange:N=>j(N.target.value),placeholder:"Enter your password"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{size:"sm",onClick:H,isLoading:h.isPending,children:[e.jsx(W,{className:"w-4 h-4"})," Regenerate Codes"]}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>{b(!1),j("")},children:"Cancel"})]})]})]}):e.jsxs(S,{children:[e.jsxs("h2",{className:"text-lg font-semibold text-stone-900 mb-2 flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5 text-stone-400"})," Two-Factor Authentication"]}),e.jsx("p",{className:"text-sm text-stone-500 mb-4",children:"Add an extra layer of security to your account by requiring a verification code from your authenticator app when signing in."}),e.jsx("div",{className:"bg-stone-50 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary-100 text-primary-600 flex items-center justify-center shrink-0",children:e.jsx(Y,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-stone-900",children:"Authenticator App"}),e.jsx("p",{className:"text-xs text-stone-500 mt-0.5",children:"Use an app like Google Authenticator, Authy, or 1Password to generate verification codes."})]})]})}),e.jsxs(P,{onClick:V,isLoading:o.isPending,children:[e.jsx(Y,{className:"w-4 h-4"})," Enable Two-Factor Authentication"]})]})}function Ms(){const{data:i,isLoading:d}=He(),o=Ge(),u=Ye(),{data:g,isLoading:h}=Ve(),p=new URLSearchParams(window.location.search).get("connected")==="1",s=async()=>{try{const c=await o.mutateAsync();window.location.href=c.url}catch(c){const m=c instanceof Error?c.message:"Failed to create Stripe account";v.error(m)}},a=async()=>{try{const c=await u.mutateAsync();window.location.href=c.url}catch(c){const m=c instanceof Error?c.message:"Failed to refresh onboarding link";v.error(m)}},t=g?.data||[],n=c=>{switch(c){case"completed":return"success";case"pending":case"processing":return"warning";case"failed":return"danger";case"refunded":return"default";default:return"default"}};if(d)return e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(D,{className:"w-8 h-8 animate-spin text-primary-500"})})});const r=i?.stripe_onboarded,f=!!i?.stripe_account_id;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs("h2",{className:"text-lg font-semibold text-stone-900 mb-2 flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-primary-500"})," Stripe Connect"]}),e.jsx("p",{className:"text-sm text-stone-500 mb-6",children:"Connect your Stripe account to receive payments from students for rotation placements."}),p&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-4 bg-green-50 border border-green-200 rounded-xl text-sm text-green-800",children:[e.jsx(Z,{className:"w-4 h-4 shrink-0"}),"Stripe account connected successfully! It may take a moment for status to update."]}),r?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 border border-green-200 rounded-xl",children:[e.jsx(Z,{className:"w-5 h-5 text-green-600 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900 text-sm",children:"Stripe Account Connected"}),e.jsxs("p",{className:"text-xs text-green-700 mt-0.5",children:["Account ID: ",i?.stripe_account_id]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-stone-50 rounded-xl",children:[e.jsx("span",{className:"text-sm text-stone-600",children:"Charges"}),e.jsx(F,{variant:i?.charges_enabled?"success":"warning",size:"sm",children:i?.charges_enabled?"Enabled":"Pending"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-stone-50 rounded-xl",children:[e.jsx("span",{className:"text-sm text-stone-600",children:"Payouts"}),e.jsx(F,{variant:i?.payouts_enabled?"success":"warning",size:"sm",children:i?.payouts_enabled?"Enabled":"Pending"})]})]}),(!i?.charges_enabled||!i?.payouts_enabled)&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded-xl text-sm text-amber-800",children:[e.jsx(de,{className:"w-4 h-4 shrink-0"}),"Some features are still pending. You may need to complete additional verification in Stripe."]})]}):f?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-amber-50 border border-amber-200 rounded-xl",children:[e.jsx(de,{className:"w-5 h-5 text-amber-600 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-900 text-sm",children:"Onboarding Incomplete"}),e.jsx("p",{className:"text-xs text-amber-700 mt-0.5",children:"Your Stripe account has been created but onboarding isn't finished yet."})]})]}),e.jsxs(P,{onClick:a,isLoading:u.isPending,children:[e.jsx(ds,{className:"w-4 h-4"})," Continue Onboarding",e.jsx(J,{className:"w-3.5 h-3.5 ml-1"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-stone-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary-100 text-primary-600 flex items-center justify-center shrink-0",children:e.jsx(z,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-stone-900",children:"Accept Payments"}),e.jsx("p",{className:"text-xs text-stone-500 mt-0.5",children:"Set up Stripe Connect to accept payments directly for rotation placements. Stripe handles all payment processing, compliance, and payouts."})]})]})}),e.jsxs(P,{onClick:s,isLoading:o.isPending,children:[e.jsx(z,{className:"w-4 h-4"})," Connect with Stripe",e.jsx(J,{className:"w-3.5 h-3.5 ml-1"})]})]})]}),e.jsxs(S,{children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-900 mb-4",children:"Payment History"}),h?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(D,{className:"w-6 h-6 animate-spin text-primary-500"})}):t.length===0?e.jsxs("div",{className:"text-center py-8 text-stone-400",children:[e.jsx(z,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No payments yet"})]}):e.jsx("div",{className:"space-y-3",children:t.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl border border-stone-200 hover:border-stone-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:`w-9 h-9 rounded-lg flex items-center justify-center shrink-0 ${c.status==="completed"?"bg-green-50 text-green-600":c.status==="refunded"?"bg-stone-100 text-stone-500":"bg-amber-50 text-amber-600"}`,children:e.jsx(z,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium text-stone-900",children:["$",Number(c.amount).toFixed(2)," ",c.currency.toUpperCase()]}),e.jsxs("p",{className:"text-xs text-stone-500 truncate",children:[c.paid_at?new Date(c.paid_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):new Date(c.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),c.platform_fee>0&&` · Fee: $${Number(c.platform_fee).toFixed(2)}`]})]})]}),e.jsx(F,{variant:n(c.status),size:"sm",children:c.status})]},c.id))})]})]})}function ks(){const{data:i,isLoading:d}=Ke(),o=Xe(),u=We(),g=a=>{o.mutate({plan:"pro",interval:a},{onSuccess:t=>{window.location.href=t.url},onError:t=>{const n=t instanceof Error?t.message:"Failed to start checkout";v.error(n)}})},h=()=>{u.mutate(void 0,{onSuccess:a=>{window.location.href=a.url},onError:a=>{const t=a instanceof Error?a.message:"Failed to open billing portal";v.error(t)}})};if(d)return e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(D,{className:"w-8 h-8 animate-spin text-primary-500"})})});const x=i?.plan==="pro",p=i?.trial_active,s=i?.needs_upgrade;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-900 mb-4",children:"Your Plan"}),e.jsx("div",{className:`p-4 rounded-xl border ${s?"bg-amber-50 border-amber-200":x?"bg-primary-50 border-primary-200":"bg-green-50 border-green-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-base font-bold text-stone-900 capitalize",children:[i?.plan||"free"," Plan"]}),e.jsx(F,{variant:x?"primary":s?"warning":"success",size:"sm",children:x?"Active":s?"Expired":"Active"})]}),e.jsx("p",{className:"text-sm text-stone-500 mt-1",children:x?`Subscription ${i?.subscription_status==="active"?"active":i?.subscription_status||""}`:p&&i?.trial_days_remaining!==null?`${i.trial_days_remaining} days left in trial · ${i.free_rotations_used}/${i.free_rotations_limit} free rotation used`:s?"Your free trial has ended. Upgrade to continue applying for rotations.":`${i?.free_rotations_used||0}/${i?.free_rotations_limit||1} free rotation used`})]}),x&&e.jsxs(P,{variant:"outline",size:"sm",onClick:h,isLoading:u.isPending,children:[e.jsx(J,{className:"w-4 h-4"})," Manage Billing"]})]})})]}),!x&&e.jsxs(S,{children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-900 mb-4",children:"Upgrade to Pro"}),e.jsx("p",{className:"text-sm text-stone-500 mb-6",children:"Get unlimited rotation applications and premium features."}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>g("month"),disabled:o.isPending,className:"p-4 rounded-xl border-2 border-stone-200 hover:border-primary-300 transition-all text-left",children:[e.jsxs("p",{className:"text-lg font-bold text-stone-900",children:["$9.99",e.jsx("span",{className:"text-sm font-normal text-stone-500",children:"/month"})]}),e.jsx("p",{className:"text-xs text-stone-500 mt-1",children:"Billed monthly, cancel anytime"})]}),e.jsxs("button",{onClick:()=>g("year"),disabled:o.isPending,className:"p-4 rounded-xl border-2 border-primary-300 bg-primary-50 hover:bg-primary-100 transition-all text-left relative",children:[e.jsx("div",{className:"absolute -top-2.5 right-3",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-green-500 text-white text-xs font-semibold",children:"Save 28%"})}),e.jsxs("p",{className:"text-lg font-bold text-stone-900",children:["$86",e.jsx("span",{className:"text-sm font-normal text-stone-500",children:"/year"})]}),e.jsx("p",{className:"text-xs text-stone-500 mt-1",children:"$7.17/month, billed annually (save 28%)"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("p",{className:"text-xs font-semibold text-stone-700 mb-2",children:"What's included in Pro:"}),e.jsx("ul",{className:"grid sm:grid-cols-2 gap-1.5 text-xs text-stone-600",children:["Unlimited rotation applications","Priority application badge","Saved search alerts","Advanced analytics & insights","Preceptor matching AI","Priority support"].map(a=>e.jsxs("li",{className:"flex items-center gap-1.5",children:[e.jsx(Z,{className:"w-3.5 h-3.5 text-green-500 shrink-0"})," ",a]},a))})]})]})]})}function Rs(){const{user:i}=te(),{data:d,isLoading:o}=qe(),u=Ze(),[g,h]=_.useState(null),x=g??d?.preferences??{application_updates:!0,hour_log_reviews:!0,evaluations:!0,site_join_requests:!0,reminders:!0,product_updates:!1};d?.preferences&&!g&&h({...d.preferences});const p=r=>{h(f=>({...f,[r]:!f[r]}))},s=async()=>{if(g)try{await u.mutateAsync(g),v.success("Notification preferences saved")}catch(r){const f=r instanceof Error?r.message:"Failed to save preferences";v.error(f)}},a=i?.role||"student",n=[{key:"application_updates",label:"Application Updates",desc:"New applications, status changes, and review notifications"},{key:"hour_log_reviews",label:"Hour Log Reviews",desc:"Notifications when hour logs are submitted or reviewed"},{key:"evaluations",label:"Evaluations",desc:"Notifications about new evaluations"},{key:"site_join_requests",label:"Site Join Requests",desc:"Requests to join sites, approvals, and assignments"},{key:"reminders",label:"Reminders",desc:"Reminders for upcoming deadlines and tasks"},{key:"product_updates",label:"Product Updates",desc:"Hear about new features and improvements"}].filter(r=>!r.roles||r.roles.includes(a));return o?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(D,{className:"w-8 h-8 animate-spin text-primary-500"})})}):e.jsxs(S,{children:[e.jsx("h2",{className:"text-lg font-semibold text-stone-900 mb-6",children:"Notification Preferences"}),e.jsx("div",{className:"space-y-4",children:n.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl border border-stone-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-stone-900 text-sm",children:r.label}),e.jsx("p",{className:"text-xs text-stone-500 mt-0.5",children:r.desc})]}),e.jsx("button",{onClick:()=>p(r.key),className:`relative w-11 h-6 rounded-full transition-colors ${x[r.key]?"bg-primary-500":"bg-stone-300"}`,children:e.jsx("div",{className:`absolute top-0.5 w-5 h-5 rounded-full bg-white shadow transition-transform ${x[r.key]?"translate-x-5.5 left-0.5":"left-0.5"}`})})]},r.key))}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(P,{onClick:s,isLoading:u.isPending,children:[e.jsx(ne,{className:"w-4 h-4"})," Save Preferences"]})})]})}export{tt as Settings};
