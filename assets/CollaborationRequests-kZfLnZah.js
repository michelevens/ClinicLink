import{a as L,r as t,cF as O,cE as u,j as e,f as o,af as _,X as $,w as z,a1 as B,e as G,g as H,t as n}from"./index-GzcG7CSS.js";import{u as U}from"./usePageTitle-CSRQyC0a.js";import{M as Y}from"./map-pin-B8WKBtoC.js";const W=["Family Practice","Internal Medicine","Pediatrics","Emergency Medicine","Psychiatry","OB/GYN","Surgery","Cardiology","Neurology","Oncology","Geriatrics","Urgent Care","Orthopedics","Dermatology"];function V(){U("My Requests");const{user:X}=L(),[m,R]=t.useState([]),[k,h]=t.useState(!0),[P,a]=t.useState(!1),[p,b]=t.useState(!1),[q,M]=t.useState([]),[f,g]=t.useState("np"),[l,j]=t.useState([]),[i,N]=t.useState(""),[v,y]=t.useState("telehealth"),[r,w]=t.useState(""),[C,S]=t.useState("");t.useEffect(()=>{c(),O.getAll({supervision_required:!0}).then(s=>{M(s.data||[])}).catch(()=>{})},[]);const c=()=>{h(!0),u.listRequests().then(s=>{R(s.data||[])}).catch(()=>{}).finally(()=>h(!1))},D=async s=>{if(s.preventDefault(),!l.length||!i||!r){n.error("Please fill in all required fields");return}b(!0);try{await u.createRequest({profession_type:f,states_requested:l,specialty:i,practice_model:v,expected_start_date:r,preferred_supervision_model:C||void 0}),n.success("Request created! We're finding matching physicians."),a(!1),d(),c()}catch{n.error("Failed to create request")}finally{b(!1)}},F=async s=>{try{await u.closeRequest(s),n.success("Request closed"),c()}catch{n.error("Failed to close request")}},d=()=>{g("np"),j([]),N(""),y("telehealth"),w(""),S("")},T=s=>{j(x=>x.includes(s)?x.filter(I=>I!==s):[...x,s])},E={open:"bg-blue-100 text-blue-700",matched:"bg-emerald-100 text-emerald-700",closed:"bg-stone-100 text-stone-600"},A=q.filter(s=>s.supervision_required).map(s=>s.state).sort();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-stone-900",children:"Collaboration Requests"}),e.jsx("p",{className:"text-stone-500 mt-1",children:"Create and manage your supervision requests"})]}),e.jsxs(o,{onClick:()=>a(!0),className:"!rounded-xl",children:[e.jsx(_,{className:"w-4 h-4"})," New Request"]})]}),P&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-stone-100",children:[e.jsx("h2",{className:"font-semibold text-stone-900",children:"New Collaboration Request"}),e.jsx("button",{onClick:()=>{a(!1),d()},className:"p-1.5 rounded-lg text-stone-400 hover:text-stone-600 hover:bg-stone-100",children:e.jsx($,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:D,className:"p-5 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-stone-700 mb-1",children:"Profession Type *"}),e.jsx("div",{className:"flex gap-3",children:["np","pa"].map(s=>e.jsx("button",{type:"button",onClick:()=>g(s),className:`flex-1 py-2.5 rounded-xl border text-sm font-medium transition-all ${f===s?"border-indigo-500 bg-indigo-50 text-indigo-700":"border-stone-200 text-stone-600 hover:bg-stone-50"}`,children:s.toUpperCase()},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-stone-700 mb-1",children:"States (supervision required) *"}),e.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-32 overflow-y-auto",children:A.map(s=>e.jsx("button",{type:"button",onClick:()=>T(s),className:`px-3 py-1 rounded-lg text-xs font-medium transition-all ${l.includes(s)?"bg-indigo-500 text-white":"bg-stone-100 text-stone-600 hover:bg-stone-200"}`,children:s},s))}),l.length>0&&e.jsxs("p",{className:"text-xs text-indigo-600 mt-1",children:[l.length," state(s) selected"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-stone-700 mb-1",children:"Specialty *"}),e.jsxs("select",{value:i,onChange:s=>N(s.target.value),className:"w-full rounded-xl border border-stone-200 px-4 py-2.5 text-sm focus:border-indigo-400 focus:ring-2 focus:ring-indigo-400/20 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select specialty..."}),W.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-stone-700 mb-1",children:"Practice Model *"}),e.jsxs("select",{value:v,onChange:s=>y(s.target.value),className:"w-full rounded-xl border border-stone-200 px-4 py-2.5 text-sm focus:border-indigo-400 focus:ring-2 focus:ring-indigo-400/20 focus:outline-none",children:[e.jsx("option",{value:"telehealth",children:"Telehealth"}),e.jsx("option",{value:"in_person",children:"In-Person"}),e.jsx("option",{value:"hybrid",children:"Hybrid"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-stone-700 mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",value:r,onChange:s=>w(s.target.value),className:"w-full rounded-xl border border-stone-200 px-4 py-2.5 text-sm focus:border-indigo-400 focus:ring-2 focus:ring-indigo-400/20 focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-stone-700 mb-1",children:"Preferred Supervision Model"}),e.jsxs("select",{value:C,onChange:s=>S(s.target.value),className:"w-full rounded-xl border border-stone-200 px-4 py-2.5 text-sm focus:border-indigo-400 focus:ring-2 focus:ring-indigo-400/20 focus:outline-none",children:[e.jsx("option",{value:"",children:"No preference"}),e.jsx("option",{value:"telehealth",children:"Telehealth"}),e.jsx("option",{value:"in_person",children:"In-Person"}),e.jsx("option",{value:"hybrid",children:"Hybrid"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>{a(!1),d()},className:"flex-1 !rounded-xl",children:"Cancel"}),e.jsx(o,{type:"submit",disabled:p,className:"flex-1 !rounded-xl",children:p?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 animate-spin"})," Creating..."]}):"Create Request"})]})]})]})}),k?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsxs("div",{className:"bg-white rounded-2xl border border-stone-200 p-6 animate-pulse",children:[e.jsx("div",{className:"h-5 bg-stone-200 rounded w-1/3 mb-3"}),e.jsx("div",{className:"h-4 bg-stone-100 rounded w-2/3"})]},s))}):m.length===0?e.jsxs("div",{className:"bg-white rounded-2xl border border-stone-200 p-12 text-center",children:[e.jsx(B,{className:"w-12 h-12 text-stone-300 mx-auto mb-4"}),e.jsx("h3",{className:"font-semibold text-stone-700 mb-1",children:"No Requests Yet"}),e.jsx("p",{className:"text-sm text-stone-500 mb-4",children:"Create your first collaboration request to find a supervising physician"}),e.jsxs(o,{onClick:()=>a(!0),className:"!rounded-xl",children:[e.jsx(_,{className:"w-4 h-4"})," Create Request"]})]}):e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs("div",{className:"bg-white rounded-2xl border border-stone-200 p-6 hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-stone-900",children:s.specialty}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${E[s.status]||""}`,children:s.status}),e.jsx("span",{className:"text-xs bg-stone-100 text-stone-500 px-2 py-0.5 rounded-full uppercase",children:s.profession_type})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-stone-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"w-3.5 h-3.5"})," ",s.states_requested.join(", ")]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-3.5 h-3.5"})," ",new Date(s.expected_start_date).toLocaleDateString()]}),e.jsx("span",{className:"capitalize",children:s.practice_model.replace("_"," ")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.matches_count!==void 0&&s.matches_count>0&&e.jsxs("span",{className:"text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded-lg font-medium",children:[s.matches_count," match",s.matches_count!==1?"es":""]}),s.status==="open"&&e.jsx("button",{onClick:()=>F(s.id),className:"text-xs text-stone-400 hover:text-red-500 transition-colors",children:"Close"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-stone-400",children:[e.jsx(H,{className:"w-3 h-3"})," Created ",new Date(s.created_at).toLocaleDateString()]})]},s.id))})]})}export{V as default};
