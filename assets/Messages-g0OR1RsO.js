import{c as F,r as d,a as w,bN as H,j as e,d as $,U as z,a1 as G,bO as K,bP as O,m as Y,as as V,$ as A,bQ as Q,bR as X,X as J,w as D,bS as W,f as T,t as M,y as Z,u as ee,p as se,av as B,af as te}from"./index-GzcG7CSS.js";import{M as re}from"./Modal-CA0K5bCb.js";import{I as ae}from"./Input-B5MQDJHu.js";import{u as ne}from"./usePageTitle-CSRQyC0a.js";const oe=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],k=F("megaphone",oe);function ie(i){const n=new Date(i),u=new Date().getTime()-n.getTime(),t=Math.floor(u/(1e3*60*60*24));return t===0?n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t===1?"Yesterday":t<7?n.toLocaleDateString([],{weekday:"short"}):n.toLocaleDateString([],{month:"short",day:"numeric"})}const le={student:"bg-blue-100 text-blue-700",preceptor:"bg-green-100 text-green-700",site_manager:"bg-purple-100 text-purple-700",coordinator:"bg-amber-100 text-amber-700",professor:"bg-teal-100 text-teal-700",admin:"bg-red-100 text-red-700"};function de({selectedId:i,onSelect:n}){const[r,u]=d.useState(""),{user:t}=w(),{data:f,isLoading:c}=H(),o=(f?.data??[]).filter(s=>r?s.users.filter(p=>p.id!==t?.id).some(p=>`${p.first_name} ${p.last_name}`.toLowerCase().includes(r.toLowerCase())):!0);function m(s){return s.users.find(h=>h.id!==t?.id)||s.users[0]}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3 border-b border-stone-100",children:e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-stone-400"}),e.jsx("input",{type:"text",placeholder:"Search conversations...",value:r,onChange:s=>u(s.target.value),className:"w-full pl-9 pr-3 py-2 rounded-lg border border-stone-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:c?e.jsx("div",{className:"p-4 text-center text-stone-400 text-sm",children:"Loading..."}):o.length===0?e.jsx("div",{className:"p-4 text-center text-stone-400 text-sm",children:r?"No conversations found":"No conversations yet"}):o.map(s=>{const h=m(s),p=s.id===i,b=s.unread_count>0,a=s.is_broadcast;return e.jsxs("button",{onClick:()=>n(s.id),className:`w-full text-left px-3 py-3 flex items-start gap-3 transition-colors border-b border-stone-50 ${p?"bg-primary-50":b?"bg-stone-50 hover:bg-stone-100":"hover:bg-stone-50"}`,children:[a?e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold shrink-0 bg-amber-100 text-amber-700",children:e.jsx(k,{className:"w-5 h-5"})}):s.is_group?e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold shrink-0 bg-purple-100 text-purple-700",children:e.jsx(z,{className:"w-5 h-5"})}):e.jsxs("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold shrink-0 ${le[h?.role||"student"]}`,children:[h?.first_name?.[0],h?.last_name?.[0]]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx("span",{className:`text-sm truncate ${b?"font-semibold text-stone-900":"font-medium text-stone-700"}`,children:a?s.subject||"Broadcast":`${h?.first_name} ${h?.last_name}`}),a&&e.jsx("span",{className:"shrink-0 text-[10px] font-semibold px-1.5 py-0.5 rounded-full bg-amber-100 text-amber-700",children:"Broadcast"})]}),s.latest_message&&e.jsx("span",{className:"text-xs text-stone-400 shrink-0 ml-2",children:ie(s.latest_message.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("p",{className:`text-xs truncate flex-1 ${b?"text-stone-700 font-medium":"text-stone-500"}`,children:s.latest_message?(s.latest_message.sender_id===t?.id?"You: ":"")+s.latest_message.body:"No messages yet"}),b&&e.jsx("span",{className:"shrink-0 w-5 h-5 rounded-full bg-primary-600 text-white text-xs font-bold flex items-center justify-center",children:s.unread_count>9?"9+":s.unread_count})]})]})]},s.id)})})]})}function ce({message:i,isMine:n,showSender:r}){const u=new Date(i.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.jsx("div",{className:`flex ${n?"justify-end":"justify-start"} ${r?"mt-2":"mt-0.5"}`,children:e.jsxs("div",{className:`max-w-[75%] ${n?"items-end":"items-start"}`,children:[r&&!n&&i.sender&&e.jsxs("p",{className:"text-xs text-stone-500 mb-1 ml-1",children:[i.sender.first_name," ",i.sender.last_name]}),e.jsxs("div",{className:`px-3.5 py-2 rounded-2xl text-sm leading-relaxed ${n?"bg-primary-600 text-white rounded-br-md":"bg-white border border-stone-200 text-stone-800 rounded-bl-md"}`,children:[e.jsx("p",{className:"whitespace-pre-wrap break-words",children:i.body}),e.jsx("p",{className:`text-[10px] mt-1 ${n?"text-primary-200":"text-stone-400"}`,children:u})]})]})})}const me=[{id:"student-hour-review",label:"Request Hour Review",body:"Hi, I have submitted my clinical hours for review. Could you please take a look at them when you have a chance? Thank you!",roles:["student"],category:"Requests"},{id:"student-thank",label:"Thank Preceptor",body:"Thank you so much for your guidance and mentorship during my rotation. I really appreciate the time you spent teaching me and the clinical experiences you provided.",roles:["student"],category:"General"},{id:"student-rotation-question",label:"Ask About Rotation",body:"Hi, I had a question about my upcoming rotation. Could you provide more details about the schedule, expectations, and any preparation I should do beforehand? Thank you!",roles:["student"],category:"Requests"},{id:"preceptor-hours-approved",label:"Hours Approved",body:"I have reviewed and approved your submitted clinical hours. Keep up the great work!",roles:["preceptor"],category:"Reviews"},{id:"preceptor-hours-revision",label:"Hours Need Revision",body:"I reviewed your submitted hours and noticed some discrepancies. Could you please review and resubmit with the necessary corrections? Let me know if you have any questions.",roles:["preceptor"],category:"Reviews"},{id:"preceptor-eval-reminder",label:"Evaluation Reminder",body:"This is a friendly reminder that your evaluation is coming up soon. Please make sure your hours are up to date and reach out if you have any questions about the evaluation process.",roles:["preceptor"],category:"Reminders"},{id:"coord-announcement",label:"Program Announcement",body:"Dear students, I wanted to share an important update regarding our clinical rotation program. Please review the following information carefully.",roles:["coordinator"],category:"Announcements"},{id:"coord-app-update",label:"Application Update",body:"I wanted to provide an update on your rotation application. Please log in to ClinicLink to check the latest status and any required actions on your part.",roles:["coordinator"],category:"Updates"},{id:"coord-compliance",label:"Compliance Reminder",body:"This is a reminder to ensure all your credentials and documentation are current. Please review your compliance status in ClinicLink and upload any missing or expired documents as soon as possible.",roles:["coordinator"],category:"Reminders"},{id:"general-thank-you",label:"Thank You",body:"Thank you for your help and support. I really appreciate it!",roles:["student","preceptor","coordinator","site_manager","professor","admin"],category:"General"},{id:"general-follow-up",label:"Follow Up",body:"Hi, I wanted to follow up on our previous conversation. Could you please provide an update when you get a chance? Thank you!",roles:["student","preceptor","coordinator","site_manager","professor","admin"],category:"General"},{id:"general-intro",label:"Introduction",body:"Hi, I wanted to introduce myself. I look forward to working with you this rotation. Please don't hesitate to reach out if there's anything I should know or prepare.",roles:["student","preceptor","coordinator","site_manager","professor","admin"],category:"General"}];function E({onSelect:i}){const{user:n}=w(),[r,u]=d.useState(!1),t=d.useRef(null);d.useEffect(()=>{function o(m){t.current&&!t.current.contains(m.target)&&u(!1)}return r&&document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[r]);const f=n?.role||"student",c=me.filter(o=>o.roles.includes(f)),g=[...new Set(c.map(o=>o.category))];return c.length===0?null:e.jsxs("div",{ref:t,className:"relative",children:[e.jsx("button",{type:"button",onClick:()=>u(!r),className:"p-2.5 rounded-xl text-stone-400 hover:text-stone-600 hover:bg-stone-100 transition-colors",title:"Insert template",children:e.jsx(G,{className:"w-5 h-5"})}),r&&e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-72 bg-white rounded-xl shadow-xl border border-stone-200 z-50 max-h-80 overflow-y-auto",children:[e.jsx("div",{className:"px-3 py-2 border-b border-stone-100",children:e.jsx("p",{className:"text-xs font-semibold text-stone-500 uppercase tracking-wider",children:"Message Templates"})}),g.map(o=>e.jsxs("div",{children:[e.jsx("p",{className:"px-3 pt-2 pb-1 text-xs font-medium text-stone-400",children:o}),c.filter(m=>m.category===o).map(m=>e.jsxs("button",{onClick:()=>{i(m.body),u(!1)},className:"w-full text-left px-3 py-2 hover:bg-stone-50 transition-colors",children:[e.jsx("p",{className:"text-sm font-medium text-stone-700",children:m.label}),e.jsx("p",{className:"text-xs text-stone-400 line-clamp-1",children:m.body})]},m.id))]},o))]})]})}function ue({conversationId:i,onBack:n}){const{user:r}=w(),[u,t]=d.useState([1]),f=Math.max(...u),{data:c,isLoading:g}=K(i,f),o=O(),[m,s]=d.useState(""),h=d.useRef(null),[p,b]=d.useState(0),[a,y]=d.useState([]),j=c?.messages?.data??[],_=c?.messages?.last_page??1,x=f<_,v=[...a,...j],P=c?.conversation,N=P?.users?.find(l=>l.id!==r?.id)||P?.users?.[0];d.useEffect(()=>{v.length>p&&(h.current?.scrollIntoView({behavior:p===0?"auto":"smooth"}),b(v.length))},[v.length,p]),d.useEffect(()=>{b(0),y([]),t([1])},[i]);function q(){y(l=>[...l,...j]),t(l=>[...l,f+1])}function L(){const l=m.trim();!l||o.isPending||o.mutate({conversationId:i,body:l},{onSuccess:()=>s("")})}function U(l){l.key==="Enter"&&!l.shiftKey&&(l.preventDefault(),L())}return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-stone-200 bg-white",children:[e.jsx("button",{onClick:n,className:"lg:hidden p-1.5 rounded-lg hover:bg-stone-100 text-stone-600 transition-colors",children:e.jsx(Y,{className:"w-5 h-5"})}),N&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-9 h-9 rounded-full bg-primary-100 flex items-center justify-center text-primary-700 font-semibold text-sm",children:[N.first_name[0],N.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-stone-900",children:[N.first_name," ",N.last_name]}),e.jsx("p",{className:"text-xs text-stone-500 capitalize",children:N.role?.replace("_"," ")})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-1",children:[g?e.jsx("div",{className:"text-center text-stone-400 text-sm py-8",children:"Loading messages..."}):v.length===0?e.jsx("div",{className:"text-center text-stone-400 text-sm py-8",children:"No messages yet. Say hello!"}):e.jsxs(e.Fragment,{children:[v.map((l,S)=>{const C=v[S-1],I=!C||new Date(l.created_at).toDateString()!==new Date(C.created_at).toDateString();return e.jsxs("div",{children:[I&&e.jsx("div",{className:"flex items-center justify-center py-3",children:e.jsx("span",{className:"text-xs text-stone-400 bg-stone-100 px-3 py-1 rounded-full",children:new Date(l.created_at).toLocaleDateString([],{weekday:"long",month:"short",day:"numeric"})})}),e.jsx(ce,{message:l,isMine:l.sender_id===r?.id,showSender:l.sender_id!==C?.sender_id||I})]},l.id)}),x&&e.jsx("div",{className:"flex justify-center py-3",children:e.jsxs("button",{onClick:q,className:"flex items-center gap-1.5 px-4 py-2 text-xs font-medium text-primary-600 bg-primary-50 hover:bg-primary-100 rounded-full transition-colors",children:[e.jsx(V,{className:"w-3.5 h-3.5"})," Load more messages"]})})]}),e.jsx("div",{ref:h})]}),e.jsx("div",{className:"border-t border-stone-200 bg-white px-4 py-3",children:e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx(E,{onSelect:l=>s(S=>S?S+`
`+l:l)}),e.jsx("textarea",{value:m,onChange:l=>s(l.target.value),onKeyDown:U,placeholder:"Type a message...",rows:1,className:"flex-1 resize-none rounded-xl border border-stone-200 px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 max-h-32",style:{minHeight:"42px"}}),e.jsx("button",{onClick:L,disabled:!m.trim()||o.isPending,className:"p-2.5 rounded-xl bg-primary-600 text-white hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(A,{className:"w-5 h-5"})})]})})]})}const R={student:"Student",preceptor:"Preceptor",site_manager:"Site Manager",coordinator:"Coordinator",professor:"Professor",admin:"Admin"};function xe({onClose:i,onCreated:n}){const[r,u]=d.useState(""),[t,f]=d.useState(null),[c,g]=d.useState(""),[o,m]=d.useState(""),{data:s,isLoading:h}=Q(r),p=X();function b(){!t||!c.trim()||(m(""),p.mutate({user_id:t.id,body:c.trim()},{onSuccess:a=>n(a.conversation.id),onError:a=>m(a.message)}))}return e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-stone-200",children:[e.jsx("h2",{className:"text-lg font-bold text-stone-900",children:"New Message"}),e.jsx("button",{onClick:i,className:"p-1.5 rounded-lg hover:bg-stone-100 text-stone-400 transition-colors",children:e.jsx(J,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-5 space-y-4",children:t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-stone-50 rounded-xl",children:[e.jsxs("div",{className:"w-9 h-9 rounded-full bg-primary-100 flex items-center justify-center text-primary-700 font-semibold text-sm",children:[t.first_name[0],t.last_name[0]]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-stone-900",children:[t.first_name," ",t.last_name]}),e.jsx("p",{className:"text-xs text-stone-500",children:R[t.role]||t.role})]}),e.jsx("button",{onClick:()=>f(null),className:"text-xs text-primary-600 hover:text-primary-700 font-medium",children:"Change"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(E,{onSelect:a=>g(y=>y?y+`
`+a:a)}),e.jsx("span",{className:"text-xs text-stone-400",children:"Insert a template"})]}),e.jsx("textarea",{value:c,onChange:a=>g(a.target.value),placeholder:"Type your message...",rows:3,autoFocus:!0,className:"w-full rounded-xl border border-stone-200 px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 resize-none"})]}),o&&e.jsx("p",{className:"text-sm text-red-600",children:o}),e.jsxs("button",{onClick:b,disabled:!c.trim()||p.isPending,className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-primary-600 text-white rounded-xl text-sm font-medium hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[p.isPending?e.jsx(D,{className:"w-4 h-4 animate-spin"}):e.jsx(A,{className:"w-4 h-4"}),"Send Message"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-stone-400"}),e.jsx("input",{type:"text",placeholder:"Search for a person...",value:r,onChange:a=>u(a.target.value),autoFocus:!0,className:"w-full pl-9 pr-3 py-2.5 rounded-xl border border-stone-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500"})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-1",children:h&&r.length>=2?e.jsx("div",{className:"text-center py-4 text-stone-400 text-sm",children:"Searching..."}):r.length<2?e.jsx("div",{className:"text-center py-4 text-stone-400 text-sm",children:"Type at least 2 characters to search"}):s?.length?s.map(a=>e.jsxs("button",{onClick:()=>f(a),className:"w-full text-left flex items-center gap-3 px-3 py-2.5 rounded-xl hover:bg-stone-50 transition-colors",children:[e.jsxs("div",{className:"w-9 h-9 rounded-full bg-primary-100 flex items-center justify-center text-primary-700 font-semibold text-sm",children:[a.first_name[0],a.last_name[0]]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-stone-900",children:[a.first_name," ",a.last_name]}),e.jsx("p",{className:"text-xs text-stone-500",children:R[a.role]||a.role})]})]},a.id)):e.jsx("div",{className:"text-center py-4 text-stone-400 text-sm",children:"No users found"})})]})})]})})}function he({open:i,onClose:n,onSent:r,programs:u}){const{user:t}=w(),f=t?.role==="admin",[c,g]=d.useState(""),[o,m]=d.useState(""),[s,h]=d.useState("all_students"),[p,b]=d.useState(""),[a,y]=d.useState("student"),j=W(),_=()=>{if(!c.trim()||!o.trim()){M.error("Subject and message are required");return}j.mutate({subject:c.trim(),body:o.trim(),audience:s,...s==="program"?{program_id:p}:{},...s==="role"?{role:a}:{}},{onSuccess:x=>{M.success(`Broadcast sent to ${x.recipients_count} recipient(s)`),g(""),m(""),n(),r?.(x.conversation.id)},onError:x=>{M.error(x.message||"Failed to send broadcast")}})};return e.jsx(re,{isOpen:i,onClose:n,title:"Send Broadcast",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-amber-50 rounded-xl border border-amber-200",children:[e.jsx(k,{className:"w-5 h-5 text-amber-600 shrink-0"}),e.jsx("p",{className:"text-sm text-stone-700",children:"Broadcasts send a one-way announcement to all selected recipients as a group conversation."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Audience"}),e.jsxs("select",{value:s,onChange:x=>h(x.target.value),className:"w-full rounded-xl border border-stone-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500",children:[e.jsx("option",{value:"all_students",children:"All Students"}),u&&u.length>0&&e.jsx("option",{value:"program",children:"By Program"}),f&&e.jsx("option",{value:"role",children:"By Role"})]})]}),s==="program"&&u&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Program"}),e.jsxs("select",{value:p,onChange:x=>b(x.target.value),className:"w-full rounded-xl border border-stone-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select a program..."}),u.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))]})]}),s==="role"&&f&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Role"}),e.jsxs("select",{value:a,onChange:x=>y(x.target.value),className:"w-full rounded-xl border border-stone-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500",children:[e.jsx("option",{value:"student",children:"Students"}),e.jsx("option",{value:"preceptor",children:"Preceptors"}),e.jsx("option",{value:"site_manager",children:"Site Managers"}),e.jsx("option",{value:"coordinator",children:"Coordinators"}),e.jsx("option",{value:"professor",children:"Professors"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Subject"}),e.jsx(ae,{value:c,onChange:x=>g(x.target.value),placeholder:"Announcement subject...",maxLength:255})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-1",children:"Message"}),e.jsx("textarea",{value:o,onChange:x=>m(x.target.value),placeholder:"Type your broadcast message...",rows:5,maxLength:1e4,className:"w-full rounded-xl border border-stone-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 resize-none"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(T,{variant:"secondary",onClick:n,children:"Cancel"}),e.jsx(T,{onClick:_,disabled:j.isPending||!c.trim()||!o.trim(),children:j.isPending?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 animate-spin"})," Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4"})," Send Broadcast"]})})]})]})})}function ye(){ne("Messages");const{id:i}=Z(),n=ee(),{user:r}=w(),[u,t]=d.useState(!1),[f,c]=d.useState(!1),g=r?.role==="coordinator"||r?.role==="admin",[o,m]=d.useState([]);return d.useEffect(()=>{!g||!r?.universityId||se.programs(r.universityId).then(s=>{m(s.map(h=>({id:h.id,name:h.name})))}).catch(()=>{})},[g,r?.universityId]),e.jsxs("div",{className:"h-[calc(100vh-4rem)] lg:h-[calc(100vh-0rem)] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-stone-200 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"w-6 h-6 text-primary-600"}),e.jsx("h1",{className:"text-xl font-bold text-stone-900",children:"Messages"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g&&e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-4 py-2 bg-amber-500 text-white rounded-xl text-sm font-medium hover:bg-amber-600 transition-colors",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Broadcast"})]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-xl text-sm font-medium hover:bg-primary-700 transition-colors",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"New Message"})]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:`${i?"hidden lg:flex":"flex"} w-full lg:w-80 flex-col border-r border-stone-200 bg-white`,children:e.jsx(de,{selectedId:i||null,onSelect:s=>n(`/messages/${s}`)})}),e.jsx("div",{className:`${i?"flex":"hidden lg:flex"} flex-1 flex-col bg-stone-50`,children:i?e.jsx(ue,{conversationId:i,onBack:()=>n("/messages")}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-stone-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(B,{className:"w-16 h-16 mx-auto mb-3 opacity-30"}),e.jsx("p",{className:"text-lg font-medium",children:"Select a conversation"}),e.jsx("p",{className:"text-sm mt-1",children:"Choose from existing conversations or start a new one"})]})})})]}),u&&e.jsx(xe,{onClose:()=>t(!1),onCreated:s=>{t(!1),n(`/messages/${s}`)}}),f&&e.jsx(he,{open:f,onClose:()=>c(!1),onSent:s=>{c(!1),n(`/messages/${s}`)},programs:o})]})}export{ye as Messages};
